{"title":"Amazon_EKS_V2R4","id":"9c25f284-4692-4750-b60b-d247abe9c93d","stigs":[{"stig_name":"Kubernetes Security Technical Implementation Guide","display_name":"Kubernetes","stig_id":"Kubernetes_STIG","release_info":"Release: 4 Benchmark Date: 02 Jul 2025","version":"2","uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","reference_identifier":"5376","size":94,"rules":[{"uuid":"bb37732c-665b-4f9c-ba05-7fa789cbe4bf","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242376","rule_id":"SV-242376r960759","rule_id_src":"SV-242376r960759_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000150","group_title":"The Kubernetes Controller Manager must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","rule_title":"The Kubernetes Controller Manager must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","fix_text":"Edit the Kubernetes Controller Manager manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--tls-min-version\" to \"VersionTLS12\" or higher.","false_positives":"","false_negatives":"","discussion":"The Kubernetes Controller Manager will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.\n\nThe use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and key store. To enable the minimum version of TLS to be used by the Kubernetes Controller Manager, the setting \"tls-min-version\" must be set.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i tls-min-version * \n\nIf the setting \"tls-min-version\" is not configured in the Kubernetes Controller Manager manifest file or it is set to \"VersionTLS10\" or \"VersionTLS11\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000068"],"group_tree":[{"id":"V-242376","title":"SRG-APP-000014-CTR-000035","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Amazon EKS manages the control plane (incl. controller manager). Customers cannot set --tls-min-version. TLS 1.2+ is enforced by AWS for FIPS endpoints and service API traffic. See AWS FIPS endpoints (TLS 1.2 required): https://docs.aws.amazon.com/general/latest/gr/rande.html#FIPS-endpoints","srg_id":"SRG-APP-000014-CTR-000035"},{"uuid":"a67fb290-db21-4a99-83cc-a28a0437f12e","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242377","rule_id":"SV-242377r960759","rule_id_src":"SV-242377r960759_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000160","group_title":"The Kubernetes Scheduler must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","rule_title":"The Kubernetes Scheduler must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","fix_text":"Edit the Kubernetes Scheduler manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--tls-min-version\" to \"VersionTLS12\" or higher.","false_positives":"","false_negatives":"","discussion":"The Kubernetes Scheduler will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.\n\nThe use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and keystore. To enable the minimum version of TLS to be used by the Kubernetes API Server, the setting \"tls-min-version\" must be set.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i tls-min-version * \n\nIf the setting \"tls-min-version\" is not configured in the Kubernetes Scheduler manifest file or it is set to \"VersionTLS10\" or \"VersionTLS11\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000068"],"group_tree":[{"id":"V-242377","title":"SRG-APP-000014-CTR-000035","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Amazon EKS manages the Kubernetes scheduler. Customers cannot configure scheduler flags such as --tls-min-version. Control-plane traffic is protected by AWS; FIPS endpoints require TLS 1.2+. See AWS FIPS endpoints (TLS 1.2 required): https://docs.aws.amazon.com/general/latest/gr/rande.html#FIPS-endpoints","srg_id":"SRG-APP-000014-CTR-000035"},{"uuid":"47b5f829-5dcd-4300-88c9-fe231283589c","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242378","rule_id":"SV-242378r960759","rule_id_src":"SV-242378r960759_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000170","group_title":"The Kubernetes API Server must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","rule_title":"The Kubernetes API Server must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--tls-min-version\" to \"VersionTLS12\" or higher.","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.\n\nThe use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and keystore. To enable the minimum version of TLS to be used by the Kubernetes API Server, the setting \"tls-min-version\" must be set.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i tls-min-version * \n\nIf the setting \"tls-min-version\" is not configured in the Kubernetes API Server manifest file or it is set to \"VersionTLS10\" or \"VersionTLS11\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000068"],"group_tree":[{"id":"V-242378","title":"SRG-APP-000014-CTR-000040","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Amazon EKS manages the Kubernetes API server; customers cannot configure flags like --tls-min-version. AWS enforces TLS 1.2+ on service API endpoints, which includes the EKS Kubernetes API endpoint. See AWS FIPS endpoints (TLS 1.2 required): https://docs.aws.amazon.com/general/latest/gr/rande.html#FIPS-endpoints","srg_id":"SRG-APP-000014-CTR-000040"},{"uuid":"dccc58d3-ac86-4ee1-aca2-f6c0da5ea564","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242379","rule_id":"SV-242379r960759","rule_id_src":"SV-242379r960759_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000180","group_title":"The Kubernetes etcd must use TLS to protect the confidentiality of sensitive data during electronic dissemination.","rule_title":"The Kubernetes etcd must use TLS to protect the confidentiality of sensitive data during electronic dissemination.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--auto-tls\" to \"false\".","false_positives":"","false_negatives":"","discussion":"Kubernetes etcd will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.\n\nThe use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and keystore. To enable the minimum version of TLS to be used by the Kubernetes API Server, the setting \"--auto-tls\" must be set.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i  auto-tls * \n\nIf the setting \"--auto-tls\" is not configured in the Kubernetes etcd manifest file or it is set to true, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000068"],"group_tree":[{"id":"V-242379","title":"SRG-APP-000014-CTR-000035","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Amazon EKS manages the Kubernetes control plane, including the etcd cluster, so we can’t set flags like --auto-tls. AWS states for EKS that TLS 1.2 is required and TLS 1.3 is recommended for clients connecting to the service, which satisfies the STIG’s intent to disallow SSL and unauthorized TLS versions. See Infrastructure security in Amazon EKS and note that EKS’s managed control plane includes etcd.","srg_id":"SRG-APP-000014-CTR-000035"},{"uuid":"64ec2d2f-f35c-4a78-b304-c7d394a5364c","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242380","rule_id":"SV-242380r960759","rule_id_src":"SV-242380r960759_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000190","group_title":"The Kubernetes etcd must use TLS to protect the confidentiality of sensitive data during electronic dissemination.","rule_title":"The Kubernetes etcd must use TLS to protect the confidentiality of sensitive data during electronic dissemination.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--peer-auto-tls\" to \"false\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server will prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication.\n\nThe use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and keystore. To enable the minimum version of TLS to be used by the Kubernetes API Server, the setting \"--peer-auto-tls\" must be set.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -I  peer-auto-tls * \n\nIf the setting \"--peer-auto-tls\" is not configured in the Kubernetes etcd manifest file or it is set to \"true\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000068"],"group_tree":[{"id":"V-242380","title":"SRG-APP-000014-CTR-000035","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"EKS operates the etcd peer cluster within the managed control plane; customers can’t set --peer-auto-tls. AWS requires TLS 1.2 (recommended TLS 1.3) for EKS service communications, meeting the STIG aim to block SSL and legacy TLS. See Infrastructure security in Amazon EKS and the EKS Control Plane overview (control plane comprises API server nodes and the etcd cluster).","srg_id":"SRG-APP-000014-CTR-000035"},{"uuid":"712a84e4-d51a-4e10-8bb9-e28fb1ff2dde","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242381","rule_id":"SV-242381r1043176","rule_id_src":"SV-242381r1043176_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000220","group_title":"The Kubernetes Controller Manager must create unique service accounts for each work payload.","rule_title":"The Kubernetes Controller Manager must create unique service accounts for each work payload.","fix_text":"Edit the Kubernetes Controller Manager manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane.\n\nSet the value of \"--use-service-account-credentials\" to \"true\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes Controller Manager is a background process that embeds core control loops regulating cluster system state through the API Server. Every process executed in a pod has an associated service account. By default, service accounts use the same credentials for authentication. Implementing the default settings poses a High risk to the Kubernetes Controller Manager. Setting the \"--use-service-account-credential\" value lowers the attack surface by generating unique service accounts settings for each controller instance.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i use-service-account-credentials * \n\nIf the setting \"--use-service-account-credentials\" is not configured in the Kubernetes Controller Manager manifest file or it is set to \"false\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000015"],"group_tree":[{"id":"V-242381","title":"SRG-APP-000023-CTR-000055","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, the Kubernetes controller manager is part of the AWS-managed control plane, and customers can’t configure its flags (including --use-service-account-credentials). As a result, this control is inherited and fulfilled by AWS’s operation of the control plane; no customer action is possible/required. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000023-CTR-000055"},{"uuid":"f7a39307-987f-4f02-a08c-0020c2900dab","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242382","rule_id":"SV-242382r960792","rule_id_src":"SV-242382r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000270","group_title":"The Kubernetes API Server must enable Node,RBAC as the authorization mode.","rule_title":"The Kubernetes API Server must enable Node,RBAC as the authorization mode.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--authorization-mode\" to \"Node,RBAC\".","false_positives":"","false_negatives":"","discussion":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DOD-approved PKIs, all DOD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset.\n\nNode,RBAC is the method within Kubernetes to control access of users and applications. Kubernetes uses roles to grant authorization API requests made by kubelets.\n\nSatisfies: SRG-APP-000340-CTR-000770, SRG-APP-000033-CTR-000095, SRG-APP-000378-CTR-000880, SRG-APP-000033-CTR-000090","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i authorization-mode * \n\nIf the setting authorization-mode is set to \"AlwaysAllow\" in the Kubernetes API Server manifest file or is not configured, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242382","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, the kube-apiserver is AWS-managed, so customers can’t set --authorization-mode. Regardless of which authentication mode you use (aws-auth ConfigMap, EKS access entries via the API, or both), that only maps IAM principals to Kubernetes identities; authorization on the control plane is still enforced by the Node and RBAC authorizers. Link: https://docs.aws.amazon.com/eks/latest/userguide/cluster-auth.html","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"0382cd40-b7f4-456d-9d47-cb0874cfeb3a","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242383","rule_id":"SV-242383r960801","rule_id_src":"SV-242383r960801_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000290","group_title":"User-managed resources must be created in dedicated namespaces.","rule_title":"User-managed resources must be created in dedicated namespaces.","fix_text":"Move any user-managed resources from the default, kube-public, and kube-node-lease namespaces to user namespaces.","false_positives":"","false_negatives":"","discussion":"Creating namespaces for user-managed resources is important when implementing Role-Based Access Controls (RBAC). RBAC allows for the authorization of users and helps support proper API server permissions separation and network micro segmentation. If user-managed resources are placed within the default namespaces, it becomes impossible to implement policies for RBAC permission, service account usage, network policies, and more.","check_content":"To view the available namespaces, run the command:\n\nkubectl get namespaces\n\nThe default namespaces to be validated are default, kube-public, and kube-node-lease if it is created.\n\nFor the default namespace, execute the commands:\n\nkubectl config set-context --current --namespace=default\nkubectl get all\n\nFor the kube-public namespace, execute the commands:\n\nkubectl config set-context --current --namespace=kube-public\nkubectl get all\n\nFor the kube-node-lease namespace, execute the commands:\n\nkubectl config set-context --current --namespace=kube-node-lease\nkubectl get all\n\nThe only valid return values are the kubernetes service (i.e., service/kubernetes) and nothing at all.\n\nIf a return value is returned from the \"kubectl get all\" command and it is not the kubernetes service (i.e., service/kubernetes), this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242383","title":"SRG-APP-000038-CTR-000105","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"API","finding_details":"kubectl get namespaces\nkubectl get all -n default\nkubectl get all -n kube-public\nkubectl get all -n kube-node-lease\nNAME              STATUS   AGE\naflogwebservice   Active   26d\nansible-runner    Active   23d\nargocd            Active   43d\ncert-manager      Active   42d\ndefault           Active   49d\nfsm3              Active   23d\nhics              Active   6d1h\nhics-dev          Active   34d\nkube-node-lease   Active   49d\nkube-public       Active   49d\nkube-system       Active   49d\nrom3              Active   23d\nNAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE\nservice/kubernetes   ClusterIP   172.20.0.1   <none>        443/TCP   49d\nNo resources found in kube-public namespace.\nNo resources found in kube-node-lease namespace.","srg_id":"SRG-APP-000038-CTR-000105"},{"uuid":"f8fa0b6f-0989-4dc9-9486-90a7c5086479","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242384","rule_id":"SV-242384r960792","rule_id_src":"SV-242384r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000300","group_title":"The Kubernetes Scheduler must have secure binding.","rule_title":"The Kubernetes Scheduler must have secure binding.","fix_text":"Edit the Kubernetes Scheduler manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the argument \"--bind-address\" to \"127.0.0.1\".","false_positives":"","false_negatives":"","discussion":"Limiting the number of attack vectors and implementing authentication and encryption on the endpoints available to external sources is paramount when securing the overall Kubernetes cluster. The Scheduler API service exposes port 10251/TCP by default for health and metrics information use. This port does not encrypt or authenticate connections. If this port is exposed externally, an attacker can use this port to attack the entire Kubernetes cluster. By setting the bind address to localhost (i.e., 127.0.0.1), only those internal services that require health and metrics information can access the Scheduler API.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i bind-address * \n\nIf the setting \"bind-address\" is not set to \"127.0.0.1\" or is not found in the Kubernetes Scheduler manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242384","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, kube-scheduler runs on the AWS-managed control plane inside an AWS-managed VPC and isn’t customer-accessible. The scheduler’s legacy insecure HTTP port (10251) has been deprecated and removed in modern Kubernetes; health/metrics use the secure port (10259) instead. Because EKS manages and isolates control-plane components, customers cannot expose or reconfigure kube-scheduler ports, and the service is bound securely by design. (Links: EKS control plane is AWS-managed; Kubernetes control-plane ports reflect secure ports.) \n\nhttps://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html\n\nhttps://kubernetes.io/docs/reference/networking/ports-and-protocols/","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"be5f325f-7b11-4004-b549-799c630004b7","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242385","rule_id":"SV-242385r960792","rule_id_src":"SV-242385r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000310","group_title":"The Kubernetes Controller Manager must have secure binding.","rule_title":"The Kubernetes Controller Manager must have secure binding.","fix_text":"Edit the Kubernetes Controller Manager manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the argument \"--bind-address\" to \"127.0.0.1\".","false_positives":"","false_negatives":"","discussion":"Limiting the number of attack vectors and implementing authentication and encryption on the endpoints available to external sources is paramount when securing the overall Kubernetes cluster. The Controller Manager API service exposes port 10252/TCP by default for health and metrics information use. This port does not encrypt or authenticate connections. If this port is exposed externally, an attacker can use this port to attack the entire Kubernetes cluster. By setting the bind address to only localhost (i.e., 127.0.0.1), only those internal services that require health and metrics information can access the Control Manager API.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i bind-address * \n\nIf the setting bind-address is not set to \"127.0.0.1\" or is not found in the Kubernetes Controller Manager manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242385","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the controller manager runs inside an AWS-managed VPC as part of the managed control plane. Customers can’t access or edit its manifest (so you can’t set --bind-address yourself), and the controller-manager’s health/metrics endpoint isn’t exposed for scraping—only the API server endpoint exposure is configurable. This satisfies the intent of “secure binding” by design because the controller-manager isn’t reachable from your networks or the internet.\n\nWe can restrict access to the API server endpoint (public/private, CIDR allowlist) at the cluster level; this is separate from controller-manager binding but is the customer-facing control point for control-plane exposure.\n\nhttps://docs.aws.amazon.com/eks/latest/userguide/eks-architecture.html\nhttps://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html\nhttps://docs.aws.amazon.com/eks/latest/userguide/configure-endpoint.html\nhttps://docs.aws.amazon.com/eks/latest/best-practices/control_plane_monitoring.html\n","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"71134119-f6e7-487c-96c4-9c6a6cc8ea93","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242386","rule_id":"SV-242386r960792","rule_id_src":"SV-242386r960792_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000320","group_title":"The Kubernetes API server must have the insecure port flag disabled.","rule_title":"The Kubernetes API server must have the insecure port flag disabled.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane.\n\nSet the value of \"--insecure-port\" to \"0\".","false_positives":"","false_negatives":"","discussion":"By default, the API server will listen on two ports. One port is the secure port and the other port is called the \"localhost port\". This port is also called the \"insecure port\", port 8080. Any requests to this port bypass authentication and authorization checks. If this port is left open, anyone who gains access to the host on which the Control Plane is running can bypass all authorization and authentication mechanisms put in place, and have full control over the entire cluster.\n\nClose the insecure port by setting the API server's \"--insecure-port\" flag to \"0\", ensuring that the \"--insecure-bind-address\" is not set.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i insecure-port * \n\nIf the setting \"--insecure-port\" is not set to \"0\" or is not configured in the Kubernetes API server manifest file, this is a finding.\n\nNote: \"--insecure-port\" flag has been deprecated and can only be set to \"0\". **This flag  will be removed in v1.24.*","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242386","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"API: Check the version using describe_cluster SDK and check the cluster.version to see if it is greater than or equal to 1.24.","finding_details":"Run kubectl version --short. If Server Version ≥ 1.24, mark this control Not Applicable (the --insecure-port flag was removed in 1.24 per the STIG note).\n\n\nAmazon EKS manages the control plane and does not expose or allow configuring kube-apiserver flags like --insecure-port. EKS presents a single HTTPS endpoint on port 443 protected by IAM/RBAC; older “insecure” ports aren’t available. For clusters on Kubernetes v1.24+, the --insecure-port flag is removed upstream, so the requirement is inherently satisfied/NA.\n\nhttps://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html\nhttps://github.com/kubernetes/kubernetes/issues/91506","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"a2f89f4c-71d3-4093-8512-46aa390e2cef","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242387","rule_id":"SV-242387r960792","rule_id_src":"SV-242387r960792_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000330","group_title":"The Kubernetes Kubelet must have the \"readOnlyPort\" flag disabled.","rule_title":"The Kubernetes Kubelet must have the \"readOnlyPort\" flag disabled.","fix_text":"On each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nRemove the \"--read-only-port\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the config file: \nSet \"readOnlyPort\" to \"0\" or remove the setting.\n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubelet serves a small REST API with read access to port 10255. The read-only port for Kubernetes provides no authentication or authorization security control. Providing unrestricted access on port 10255 exposes Kubernetes pods and containers to malicious attacks or compromise. Port 10255 is deprecated and should be disabled.","check_content":"On each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nIf the \"--read-only-port\" option exists, this is a finding. \n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i readOnlyPort <path_to_config_file>\n\nIf the setting \"readOnlyPort\" exists and is not set to \"0\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242387","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"OS: Need to check Windows still, AL2023 Not a Finding","finding_details":"Linux:\n/usr/bin/kubelet --config=/etc/kubernetes/kubelet/config.json --config-dir=/etc/kubernetes/kubelet/config.json.d --kubeconfig=/var/lib/kubelet/kubeconfig --image-credential-provider-bin-dir=/etc/eks/image-credential-provider --image-credential-provider-config=/etc/eks/image-credential-provider/config.json --node-ip=10.101.74.221 --cloud-provider=external --hostname-override=ip-10-101-74-221.us-gov-west-1.compute.internal --node-labels=eks.amazonaws.com/nodegroup-image=ami-02e00aa602509a0c8,eks.amazonaws.com/capacityType=ON_DEMAND,eks.amazonaws.com/nodegroup=dev-linux-nodes-usgw1\n\nAL2023 Config Path: /etc/kubernetes/kubelet/config.json\n# ensure the deprecated flag is NOT present:\nps -ef | grep kubelet | grep -i -- '--read-only-port' || echo \"no flag (good)\"\n\n# confirm readOnlyPort is 0 in the kubelet config:\ngrep -i readOnlyPort /etc/kubernetes/kubelet/config.json\n\n\nWindows:\nGet-CimInstance Win32_Process -Filter \"Name='kubelet.exe'\" | Select-Object CommandLine\n","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"29d64808-5000-41aa-82ea-b4d4715dc10e","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242388","rule_id":"SV-242388r960792","rule_id_src":"SV-242388r960792_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000340","group_title":"The Kubernetes API server must have the insecure bind address not set.","rule_title":"The Kubernetes API server must have the insecure bind address not set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nRemove the value of \"--insecure-bind-address\" setting.","false_positives":"","false_negatives":"","discussion":"By default, the API server will listen on two ports and addresses. One address is the secure address and the other address is called the \"insecure bind\" address and is set by default to localhost. Any requests to this address bypass authentication and authorization checks. If this insecure bind address is set to localhost, anyone who gains access to the host on which the Control Plane is running can bypass all authorization and authentication mechanisms put in place and have full control over the entire cluster.\n\nClose or set the insecure bind address by setting the API server's \"--insecure-bind-address\" flag to an IP or leave it unset and ensure that the \"--insecure-bind-port\" is not set.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i insecure-bind-address * \n\nIf the setting \"--insecure-bind-address\" is found and set to \"localhost\" in the Kubernetes API manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242388","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, the kube-apiserver runs on the AWS-managed control plane and customers cannot configure --insecure-bind-address or --insecure-bind-port. EKS exposes only the managed HTTPS API endpoint; there is no customer-accessible “insecure bind” interface, so the STIG requirement to avoid an insecure bind is inherited and satisfied by design. Link: https://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"8887e9ed-8a9b-4da8-be8b-65d80401c238","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242389","rule_id":"SV-242389r960792","rule_id_src":"SV-242389r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000350","group_title":"The Kubernetes API server must have the secure port set.","rule_title":"The Kubernetes API server must have the secure port set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--secure-port\" to a value greater than \"0\".","false_positives":"","false_negatives":"","discussion":"By default, the API server will listen on what is rightfully called the secure port, port 6443. Any requests to this port will perform authentication and authorization checks. If this port is disabled, anyone who gains access to the host on which the Control Plane is running has full control of the entire cluster over encrypted traffic.\n\nOpen the secure port by setting the API server's \"--secure-port\" flag to a value other than \"0\".","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i secure-port * \n\nIf the setting \"--secure-port\" is set to \"0\" or is not configured in the Kubernetes API manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242389","title":"SRG-APP-000033-CTR-000100","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In EKS, the control plane is fully managed and the Kubernetes API is exposed via an AWS-managed HTTPS endpoint (fronted by a load balancer) that enforces TLS (required 1.2; recommended 1.3) on port 443. Customers can’t set or unset --secure-port on the managed API server; the insecure port is not exposed. This satisfies the STIG intent that the API server listen on a secure port and perform authn/authz.\n\nhttps://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html\nhttps://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html","srg_id":"SRG-APP-000033-CTR-000100"},{"uuid":"ea60f2d3-0028-4ea1-aa54-233382863110","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242390","rule_id":"SV-242390r960792","rule_id_src":"SV-242390r960792_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000360","group_title":"The Kubernetes API server must have anonymous authentication disabled.","rule_title":"The Kubernetes API server must have anonymous authentication disabled.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of  \"--anonymous-auth\" to \"false\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server controls Kubernetes via an API interface. A user who has access to the API essentially has root access to the entire Kubernetes cluster. To control access, users must be authenticated and authorized. By allowing anonymous connections, the controls put in place to secure the API can be bypassed.\n\nSetting \"--anonymous-auth\" to \"false\" also disables unauthenticated requests from kubelets.\n\nWhile there are instances where anonymous connections may be needed (e.g., health checks) and Role-Based Access Controls (RBACs) are in place to limit the anonymous access, this access should be disabled, and only enabled when necessary.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i anonymous-auth * \n\nIf the setting \"--anonymous-auth\" is set to \"true\" in the Kubernetes API Server manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242390","title":"SRG-APP-000033-CTR-000100","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, the kube-apiserver is part of the AWS-managed control plane and customers cannot set flags like --anonymous-auth. EKS requires clients to authenticate (via IAM-based EKS authentication such as access entries/aws-auth) before the API server authorizes requests, satisfying the requirement to disable anonymous access.\n\nhttps://docs.aws.amazon.com/eks/latest/userguide/cluster-auth.html\nhttps://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/","srg_id":"SRG-APP-000033-CTR-000100"},{"uuid":"2c1027d3-f5b7-4818-af1b-ea0f94eb79f3","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242391","rule_id":"SV-242391r960792","rule_id_src":"SV-242391r960792_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000370","group_title":"The Kubernetes Kubelet must have anonymous authentication disabled.","rule_title":"The Kubernetes Kubelet must have anonymous authentication disabled.","fix_text":"On each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nRemove the \"anonymous-auth\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the config file: \nLocate the \"authentication\" section and the \"anonymous\" subsection. Within the \"anonymous\" subsection, set \"enabled\" to \"false\".\n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"A user who has access to the Kubelet essentially has root access to the nodes contained within the Kubernetes Control Plane. To control access, users must be authenticated and authorized. By allowing anonymous connections, the controls put in place to secure the Kubelet can be bypassed.\n\nSetting anonymous authentication to \"false\" also disables unauthenticated requests from kubelets.\n\nWhile there are instances where anonymous connections may be needed (e.g., health checks) and Role-Based Access Controls (RBAC) are in place to limit the anonymous access, this access must be disabled and only enabled when necessary.","check_content":"On each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nIf the \"--anonymous-auth\" option exists, this is a finding. \n\nNote the path to the config file (identified by --config).\n\nInspect the content of the config file:\nLocate the \"anonymous\" section under \"authentication\".  In this section, if the field \"enabled\" does not exist or is set to \"true\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242391","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"OS: Not set","finding_details":"AL2023\n# 1) Verify the flag is NOT present\nps -ef | grep kubelet | grep -i -- '--anonymous-auth' || echo \"no flag (good)\"\n\n# 2) Verify config disables anonymous auth (AL2023 default path shown)\njq '.authentication.anonymous.enabled' /etc/kubernetes/kubelet/config.json\n\nWindows\n# 1) Find kubelet command line and --config path\n(Get-CimInstance Win32_Process -Filter \"Name='kubelet.exe'\").CommandLine\n\n# 2) Inspect the kubelet config JSON from that path\n$cfg = Get-Content 'C:\\etc\\kubernetes\\kubelet\\config.json' -Raw | ConvertFrom-Json\n$cfg.authentication.anonymous.enabled  # Expect: False\n\nIn Amazon EKS, kubelet runs on our worker nodes. We disable anonymous kubelet access by ensuring the --anonymous-auth flag is not used and setting authentication.anonymous.enabled=false in the kubelet config on AL2023 and Windows nodes. This meets the STIG requirement to prevent unauthenticated access to kubelet.","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"987cafcd-8ec5-49bd-8148-221d3a4b1756","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242392","rule_id":"SV-242392r1069461","rule_id_src":"SV-242392r1069461_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000380","group_title":"The Kubernetes kubelet must enable explicit authorization.","rule_title":"The Kubernetes kubelet must enable explicit authorization.","fix_text":"Edit the Kubernetes Kubelet service file in the --config directory on the Kubernetes Worker Node:\n\nSet the value of \"--authorization-mode\" to \"Webhook\" in KUBELET_SYSTEM_PODS_ARGS variable.\n\nRestart the kubelet service using the following command:\n\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubelet is the primary agent on each node. The API server communicates with each kubelet to perform tasks such as starting/stopping pods. By default, kubelets allow all authenticated requests, even anonymous ones, without requiring any authorization checks from the API server. This default behavior bypasses any authorization controls put in place to limit what users may perform within the Kubernetes cluster. To change this behavior, the default setting of AlwaysAllow for the authorization mode must be set to \"Webhook\".","check_content":"Run the following command on each Worker Node:\nps -ef | grep kubelet\nVerify that the --authorization-mode exists and is set to \"Webhook\".\n\nIf the --authorization-mode argument is not set to \"Webhook\" or doesn't exist, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242392","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, kubelet runs on our worker nodes (managed node groups). These settings are customer-controlled via the kubelet configuration file and service arguments on each node. We verify and enforce the required kubelet property in the node’s kubelet config and ensure no conflicting legacy flags are present. (Control plane is AWS-managed and out of scope for kubelet settings.)\n\nAL2023 (Linux)\n\nKubelet config file:\n/etc/kubernetes/kubelet/config.json\n\nKubelet process/args (to confirm no conflicting flags):\nview with ps -ef | grep kubelet\n\nWindows (Managed Node Group Windows AMI)\n\nKubelet config file:\nC:\\etc\\kubernetes\\kubelet\\config.json\n\nKubelet process/args (to confirm no conflicting flags):\nGet-CimInstance Win32_Process -Filter \"Name='kubelet.exe'\" | Select-Object CommandLine","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"c9827038-3dec-40be-9751-7e42fbc7e04e","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242393","rule_id":"SV-242393r960792","rule_id_src":"SV-242393r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000400","group_title":"Kubernetes Worker Nodes must not have sshd service running.","rule_title":"Kubernetes Worker Nodes must not have sshd service running.","fix_text":"To stop the sshd service, run the command:\n\nsystemctl stop sshd\n\nNote: If access to the worker node is through an SSH session, it is important to realize there are two requirements for disabling and stopping the sshd service and they should be done during the same SSH session. Disabling the service must be performed first and then the service stopped to guarantee both settings can be made if the session is interrupted.","false_positives":"","false_negatives":"","discussion":"Worker Nodes are maintained and monitored by the Control Plane. Direct access and manipulation of the nodes should not take place by administrators. Worker nodes should be treated as immutable and updated via replacement rather than in-place upgrades.","check_content":"Log in to each worker node. Verify that the sshd service is not running. To validate that the service is not running, run the command:\n\nsystemctl status sshd\n\nIf the service sshd is active (running), this is a finding.\n\nNote: If console access is not available, SSH access can be attempted. If the worker nodes cannot be reached, this requirement is \"not a finding\".","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242393","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"open","overrides":{},"comments":"OS","finding_details":"This is running and enabled on Linux","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"af4df566-15cd-4817-9f10-64c8f9f9c72a","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242394","rule_id":"SV-242394r960792","rule_id_src":"SV-242394r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000410","group_title":"Kubernetes Worker Nodes must not have the sshd service enabled.","rule_title":"Kubernetes Worker Nodes must not have the sshd service enabled.","fix_text":"To disable the sshd service, run the command:\n\nchkconfig sshd off\n\nNote: If access to the worker node is through an SSH session, it is important to realize there are two requirements for disabling and stopping the sshd service that must be done during the same SSH session. Disabling the service must be performed first and then the service stopped to guarantee both settings can be made if the session is interrupted.","false_positives":"","false_negatives":"","discussion":"Worker Nodes are maintained and monitored by the Control Plane. Direct access and manipulation of the nodes must not take place by administrators. Worker nodes must be treated as immutable and updated via replacement rather than in-place upgrades.","check_content":"Log in to each worker node. Verify that the sshd service is not enabled. To validate the service is not enabled, run the command:\n\nsystemctl is-enabled sshd.service\n\nIf the service sshd is enabled, this is a finding.\n\nNote: If console access is not available, SSH access can be attempted. If the worker nodes cannot be reached, this requirement is \"not a finding\".","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242394","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"open","overrides":{},"comments":"OS","finding_details":"This is running and enabled on Linux","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"45a99834-788b-468f-8acb-f04bdb8bb247","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242395","rule_id":"SV-242395r960792","rule_id_src":"SV-242395r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000420","group_title":"Kubernetes dashboard must not be enabled.","rule_title":"Kubernetes dashboard must not be enabled.","fix_text":"Delete the Kubernetes dashboard deployment with the following command:\n\nkubectl delete deployment kubernetes-dashboard --namespace=kube-system","false_positives":"","false_negatives":"","discussion":"While the Kubernetes dashboard is not inherently insecure on its own, it is often coupled with a misconfiguration of Role-Based Access control (RBAC) permissions that can unintentionally over-grant access. It is not commonly protected with \"NetworkPolicies\", preventing all pods from being able to reach it. In increasingly rare circumstances, the Kubernetes dashboard is exposed publicly to the internet.","check_content":"From the Control Plane, run the command:\n\nkubectl get pods --all-namespaces -l k8s-app=kubernetes-dashboard\n\nIf any resources are returned, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242395","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"API","finding_details":"This shouldn't be run from the control plane. Anywhere where the kubectl exists\n\nNo resources found ","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"8a69f82c-f21f-45c3-82f6-3b8d0b4c7f81","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242396","rule_id":"SV-242396r960792","rule_id_src":"SV-242396r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000430","group_title":"Kubernetes Kubectl cp command must give expected access and results.","rule_title":"Kubernetes Kubectl cp command must give expected access and results.","fix_text":"Upgrade the Control Plane and Worker nodes to the latest version of kubectl.","false_positives":"","false_negatives":"","discussion":"One of the tools heavily used to interact with containers in the Kubernetes cluster is kubectl. The command is the tool System Administrators used to create, modify, and delete resources. One of the capabilities of the tool is to copy files to and from running containers (i.e., kubectl cp). The command uses the \"tar\" command of the container to copy files from the container to the host executing the \"kubectl cp\" command. If the \"tar\" command on the container has been replaced by a malicious user, the command can copy files anywhere on the host machine. This flaw has been fixed in later versions of the tool. It is recommended to use kubectl versions newer than 1.12.9.","check_content":"From the Control Plane and each Worker node, check the version of kubectl by executing the command:\n\nkubectl version --client\n\nIf the Control Plane or any Worker nodes are not using kubectl version 1.12.9 or newer, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242396","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_applicable","overrides":{},"comments":"OS","finding_details":"Kubectl doesn't exist on AL2023\n\nStill need to check on windows","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"a65b5a23-0c1a-4e75-8394-8c7be03e3022","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242397","rule_id":"SV-242397r1069464","rule_id_src":"SV-242397r1069464_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-000440","group_title":"The Kubernetes kubelet staticPodPath must not enable static pods.","rule_title":"The Kubernetes kubelet staticPodPath must not enable static pods.","fix_text":"1. Remove staticPodPath setting on Kubernetes worker nodes:\n\na. On each Worker node, run the command:\n    ps -ef | grep kubelet\n\nb. Note the path to the config file (identified by --config).\n\nc. Edit the Kubernetes kubelet file in the --config directory on the Worker nodes. Remove the setting \"staticPodPath\".\n\nd. Restart the kubelet service using the following command:\n    systemctl daemon-reload && systemctl restart kubelet\n\n2. Remove Kubelet Systemd Service Arguments:\n\na. Modify the systemd Service File. Run the command:\n    sudo systemctl edit --full kubelet\n\n(Example Return:ExecStart=/usr/bin/kubelet --pod-manifest-path=/etc/kubernetes/manifests)\n\nb. Find and remove --pod-manifest-path.\n\nc. Save and exit the editor.\n\nd. Restart the kubelet service using the following command:\n    systemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Allowing kubelet to set a staticPodPath gives containers with root access permissions to traverse the hosting filesystem. The danger comes when the container can create a manifest file within the /etc/kubernetes/manifests directory. When a manifest is created within this directory, containers are entirely governed by the Kubelet not the API Server. The container is not susceptible to admission control at all. Any containers or pods instantiated in this manner are called \"static pods\" and are meant to be used for pods such as the API server, scheduler, controller, etc., not workload pods that need to be governed by the API Server.","check_content":"If staticPodPath is missing in the Kubelet config and in the systemd arguments, the node does not support static pods.\n\n1. To find the staticPodPath setting on Kubernetes worker nodes, follow these steps:\n\n a. On the Worker nodes, run the command:\n     ps -ef | grep kubelet\n\nb. Note the path to the Kubelet configuration file (identified by --config).\n    (ls /var/lib/kubelet/config.yaml is the common location.)\n\nc. Run the command:\n    grep -i staticPodPath <path_to_config_file>\n\nIf any of the Worker nodes return a value for \"staticPodPath\", this is a finding.\n\nIf staticPodPath is not in the config file, check if it is set as a command-line argument.\n\n2. Check Kubelet Systemd Service Arguments.\n\na. Run the following command to check the Kubelet service:\n    sudo systemctl cat kubelet | grep pod-manifest-path\n\nIf there is no output, staticPodPath is not set in systemd arguments.\n\nIf there is any return, this is a finding.\n\n(Example Return:ExecStart=/usr/bin/kubelet --pod-manifest-path=/etc/kubernetes/manifests\nThis means static pods are defined in /etc/kubernetes/manifests.)","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242397","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"OS: check kubelet config\n\nAl2023 doesn't have any finding","finding_details":"  # --- Begin Custom Code ---\n  # On Amazon EKS, kubelet runs on our worker nodes (managed node groups). These settings are customer-controlled via the kubelet configuration file and service arguments on each node. We verify and enforce the required kubelet property in the node’s kubelet config and ensure no conflicting legacy flags are present. (Control plane is AWS-managed and out of scope for kubelet settings.)\n  # AL2023 (Linux)\n  # Kubelet config file:\n  # /etc/kubernetes/kubelet/config.json\n  # Kubelet process/args (to confirm no conflicting flags):\n  # view with ps -ef | grep kubelet\n  # Windows (Managed Node Group Windows AMI)\n  # Kubelet config file:\n  # C:\\etc\\kubernetes\\kubelet\\config.json\n  # Kubelet process/args (to confirm no conflicting flags):\n  # Get-CimInstance Win32_Process -Filter \"Name='kubelet.exe'\" | Select-Object CommandLine\n  # --- End Custom Code ---","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"40a9d3c2-2eda-47c7-8ce0-02dbfcf53b39","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242398","rule_id":"SV-242398r960792","rule_id_src":"SV-242398r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000450","group_title":"Kubernetes DynamicAuditing must not be enabled.","rule_title":"Kubernetes DynamicAuditing must not be enabled.","fix_text":"On the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nIf any \"--feature-gates\" setting is available and contains the \"DynamicAuditing\" flag, remove the flag or set it to false.\n\nOn the each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nRemove the \"--feature-gates option\" if present.\n\nNote the path to the config file (identified by: --config).\n\nEdit the Kubernetes Kubelet config file: \nIf the \"featureGates\" setting is present, remove the \"DynamicAuditing\" flag or set the flag to false.\n\nRestart the kubelet service using the following command:\nservice kubelet restart","false_positives":"","false_negatives":"","discussion":"Protecting the audit data from change or deletion is important when an attack occurs. One way an attacker can cover their tracks is to change or delete audit records. This will either make the attack unnoticeable or make it more difficult to investigate how the attack took place and what changes were made. The audit data can be protected through audit log file protections and user authorization.\n\nOne way for an attacker to thwart these measures is to send the audit logs to another source and filter the audited results before sending them on to the original target. This can be done in Kubernetes through the configuration of dynamic audit webhooks through the DynamicAuditing flag.","check_content":"On the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nReview the feature-gates setting, if one is returned.\n\nIf the feature-gates setting is available and contains the DynamicAuditing flag set to \"true\", this is a finding.\n\nOn each Control Plane and Worker node, run the command:\nps -ef | grep kubelet\n\nIf the \"--feature-gates\" option exists, this is a finding. \n\nNote the path to the config file (identified by: --config).\n\nInspect the content of the config file:\nIf the \"featureGates\" setting is present and has the \"DynamicAuditing\" flag set to \"true\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242398","title":"SRG-APP-000033-CTR-000100","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"OS: Check kubelet","finding_details":"sudo cat /etc/kubernetes/kubelet/config.json | grep featureGates -A 10\n    \"featureGates\": {\n        \"DynamicResourceAllocation\": true,\n        \"RotateKubeletServerCertificate\": true\n    },\n\nAL2023 is fine\n\n  # --- Begin Custom Code ---\n  # On Amazon EKS, kubelet runs on our worker nodes (managed node groups). These settings are customer-controlled via the kubelet configuration file and service arguments on each node. We verify and enforce the required kubelet property in the node’s kubelet config and ensure no conflicting legacy flags are present. (Control plane is AWS-managed and out of scope for kubelet settings.)\n  # AL2023 (Linux)\n  # Kubelet config file:\n  # /etc/kubernetes/kubelet/config.json\n  # Kubelet process/args (to confirm no conflicting flags):\n  # view with ps -ef | grep kubelet\n  # Windows (Managed Node Group Windows AMI)\n  # Kubelet config file:\n  # C:\\etc\\kubernetes\\kubelet\\config.json\n  # Kubelet process/args (to confirm no conflicting flags):\n  # Get-CimInstance Win32_Process -Filter \"Name='kubelet.exe'\" | Select-Object CommandLine\n  # --- End Custom Code ---","srg_id":"SRG-APP-000033-CTR-000100"},{"uuid":"335c48ff-f3b3-4ea1-a791-a4a7147bac84","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242399","rule_id":"SV-242399r960792","rule_id_src":"SV-242399r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000460","group_title":"Kubernetes DynamicKubeletConfig must not be enabled.","rule_title":"Kubernetes DynamicKubeletConfig must not be enabled.","fix_text":"This fix is only applicable to Kubernetes version 1.25 and older.\n\nOn the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nEdit the manifest files so that every manifest has a \"--feature-gates\" setting with \"DynamicKubeletConfig=false\".\n\nOn each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nRemove the \"feature-gates\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the config file: \nAdd a \"featureGates\" setting if one does not yet exist. Add the feature gate \"DynamicKubeletConfig=false\".\n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubernetes allows a user to configure kubelets with dynamic configurations. When dynamic configuration is used, the kubelet will watch for changes to the configuration file. When changes are made, the kubelet will automatically restart. Allowing this capability bypasses access restrictions and authorizations. Using this capability, an attacker can lower the security posture of the kubelet, which includes allowing the ability to run arbitrary commands in any container running on that node.","check_content":"This check is only applicable for Kubernetes versions 1.25 and older.  \n\nOn the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nIn each manifest file, if the feature-gates does not exist, or does not contain the \"DynamicKubeletConfig\" flag, or sets the flag to \"true\", this is a finding.\n\nOn each Control Plane and Worker node, run the command:\nps -ef | grep kubelet\n\nVerify the \"feature-gates\" option is not present.\n\nNote the path to the config file (identified by --config).\n\nInspect the content of the config file:\nIf the \"featureGates\" setting is not present, or does not contain the \"DynamicKubeletConfig\", or sets the flag to \"true\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242399","title":"SRG-APP-000033-CTR-000095","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"open","overrides":{},"comments":"OS: Needs to update the kubelet featureGates in the AMI","finding_details":"DynamicKubeletConfig is not set","srg_id":"SRG-APP-000033-CTR-000095"},{"uuid":"cd17672a-96ac-4204-8751-abb6b2bd3a6b","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242400","rule_id":"SV-242400r960792","rule_id_src":"SV-242400r960792_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000470","group_title":"The Kubernetes API server must have Alpha APIs disabled.","rule_title":"The Kubernetes API server must have Alpha APIs disabled.","fix_text":"Edit any manifest file that contains the \"--feature-gates\" setting with \"AllAlpha\" set to \"true\".\n\nSet the value of \"AllAlpha\" to \"false\" or remove the setting completely. (AllAlpha - default=false)","false_positives":"","false_negatives":"","discussion":"Kubernetes allows alpha API calls within the API server. The alpha features are disabled by default since they are not ready for production and likely to change without notice. These features may also contain security issues that are rectified as the feature matures. To keep the Kubernetes cluster secure and stable, these alpha features must not be used.","check_content":"On the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nReview the \"--feature-gates\" setting, if one is returned.\n\nIf the \"--feature-gate\"s setting is available and contains the \"AllAlpha\" flag set to \"true\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-242400","title":"SRG-APP-000033-CTR-000090","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"OS: Check kubelet","finding_details":"AllAlpha not set on Linux","srg_id":"SRG-APP-000033-CTR-000090"},{"uuid":"6d1ebffb-143f-4469-9bf1-e23775672eb3","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242402","rule_id":"SV-242402r960888","rule_id_src":"SV-242402r960888_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000610","group_title":"The Kubernetes API Server must have an audit log path set.","rule_title":"The Kubernetes API Server must have an audit log path set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--audit-log-path\" to a secure location for the audit logs to be written.\n\nNote: If the API server is running as a Pod, then the manifest will also need to be updated to mount the host system filesystem where the audit log file is to be written.","false_positives":"","false_negatives":"","discussion":"When Kubernetes is started, components and user services are started for auditing startup events, and events for components and services, it is important that auditing begin on startup. Within Kubernetes, audit data for all components is generated by the API server. To enable auditing to begin, an audit policy must be defined for the events and the information to be stored with each event. It is also necessary to give a secure location where the audit logs are to be stored. If an audit log path is not specified, all audit data is sent to studio.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-log-path * \n\nIf the \"--audit-log-path\" is not set, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001464"],"group_tree":[{"id":"V-242402","title":"SRG-APP-000092-CTR-000165","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"Satisfied is audit logs to cloud watch are setup.","srg_id":"SRG-APP-000092-CTR-000165"},{"uuid":"583528be-fe2e-4f8a-aa09-686181f3ab25","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242403","rule_id":"SV-242403r986135","rule_id_src":"SV-242403r986135_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000700","group_title":"Kubernetes API Server must generate audit records that identify what type of event has occurred, identify the source of the event, contain the event results, identify any users, and identify any containers associated with the event.","rule_title":"Kubernetes API Server must generate audit records that identify what type of event has occurred, identify the source of the event, contain the event results, identify any users, and identify any containers associated with the event.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of  \"--audit-policy-file\" to the path of a file with the following content:\n    \n    # Log all requests at the RequestResponse level.\n    apiVersion: audit.k8s.io/vX (Where X is the latest apiVersion)\n    kind: Policy\n    rules:\n    - level: RequestResponse\n\nNote: If the API server is running as a Pod, then the manifest will also need to be updated to mount the host system filesystem where the audit policy file resides.","false_positives":"","false_negatives":"","discussion":"Within Kubernetes, audit data for all components is generated by the API server. This audit data is important when there are issues, to include security incidents that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to have the appropriate and required data logged. To fully understand the event, it is important to identify any users associated with the event. \n\nThe API server policy file allows for the following levels of auditing:\n      None - Do not log events that match the rule.\n      Metadata - Log request metadata (requesting user, timestamp, resource, verb, etc.) but not request or response body.\n      Request - Log event metadata and request body but not response body.\n      RequestResponse - Log event metadata, request, and response bodies.\n\nSatisfies: SRGID:SRG-APP-000092-CTR-000165, SRG-APP-000026-CTR-000070, SRG-APP-000027-CTR-000075, SRG-APP-000028-CTR-000080, SRG-APP-000101-CTR-000205, SRG-APP-000100-CTR-000200, SRG-APP-000100-CTR-000195, SRG-APP-000099-CTR-000190, SRG-APP-000098-CTR-000185, SRG-APP-000095-CTR-000170, SRG-APP-000096-CTR-000175, SRG-APP-000097-CTR-000180, SRG-APP-000507-CTR-001295, SRG-APP-000504-CTR-001280, SRG-APP-000503-CTR-001275, SRG-APP-000501-CTR-001265, SRG-APP-000500-CTR-001260, SRG-APP-000497-CTR-001245, SRG-APP-000496-CTR-001240, SRG-APP-000493-CTR-001225, SRG-APP-000492-CTR-001220, SRG-APP-000343-CTR-000780, SRG-APP-000381-CTR-000905","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-policy-file \n\nIf the audit-policy-file is not set, this is a finding. \n\nThe file given is the policy file and defines what is audited and what information is included with each event.\n\nThe policy file must look like this:\n\n# Log all requests at the RequestResponse level.\napiVersion: audit.k8s.io/vX (Where X is the latest apiVersion)\nkind: Policy\nrules:\n- level: RequestResponse\n\nIf the audit policy file does not look like above, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000018","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000135","CCI-000172","CCI-001403","CCI-001404","CCI-001487","CCI-002264"],"group_tree":[{"id":"V-242403","title":"SRG-APP-000026-CTR-000070","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"Satisfied is audit logs to cloud watch are setup.","srg_id":"SRG-APP-000026-CTR-000070"},{"uuid":"2d18e54a-cfac-47c4-a39b-01806c6e8109","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242404","rule_id":"SV-242404r960960","rule_id_src":"SV-242404r960960_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000850","group_title":"Kubernetes Kubelet must deny hostname override.","rule_title":"Kubernetes Kubelet must deny hostname override.","fix_text":"Run the command:  \nsystemctl status kubelet.  \nNote the path to the drop-in file.\n\nDetermine the path to the environment file(s) with the command: \ngrep -i EnvironmentFile <path_to_drop_in_file>.\n\nRemove the \"--hostname-override\" option from any environment file where it is present.  \n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubernetes allows for the overriding of hostnames. Allowing this feature to be implemented within the kubelets may break the TLS setup between the kubelet service and the API server. This setting also can make it difficult to associate logs with nodes if security analytics needs to take place. The better practice is to setup nodes with resolvable FQDNs and avoid overriding the hostnames.","check_content":"On the Control Plane and Worker nodes, run the command:\nps -ef | grep kubelet\n\nIf the option \"--hostname-override\" is present, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001499"],"group_tree":[{"id":"V-242404","title":"SRG-APP-000133-CTR-000290","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000133-CTR-000290"},{"uuid":"0ecacfb7-d07b-41d5-af1d-7697fc8bbf3c","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242405","rule_id":"SV-242405r960960","rule_id_src":"SV-242405r960960_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000860","group_title":"The Kubernetes manifests must be owned by root.","rule_title":"The Kubernetes manifests must be owned by root.","fix_text":"On the Control Plane, change to the /etc/kubernetes/manifest directory. Run the command:\nchown root:root *\n\nTo verify the change took place, run the command:\nls -l *\n\nAll the manifest files should be owned by root:root.","false_positives":"","false_negatives":"","discussion":"The manifest files contain the runtime configuration of the API server, proxy, scheduler, controller, and etcd. If an attacker can gain access to these files, changes can be made to open vulnerabilities and bypass user authorizations inherit within Kubernetes with RBAC implemented.","check_content":"On the Control Plane, change to the /etc/kubernetes/manifest directory. Run the command:\nls -l *\n\nEach manifest file must be owned by root:root.\n\nIf any manifest file is not owned by root:root, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001499"],"group_tree":[{"id":"V-242405","title":"SRG-APP-000133-CTR-000295","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, control-plane manifests under /etc/kubernetes/manifests are not customer-accessible; AWS manages file ownership/permissions on those hosts. This control is inherited from AWS and out of customer scope. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000133-CTR-000295"},{"uuid":"ed67c060-8289-461a-951a-ebd16e839509","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242406","rule_id":"SV-242406r960960","rule_id_src":"SV-242406r960960_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000880","group_title":"The Kubernetes KubeletConfiguration file must be owned by root.","rule_title":"The Kubernetes KubeletConfiguration file must be owned by root.","fix_text":"On the Control Plane and Worker nodes, change to the --config directory. Run the command:\nchown root:root kubelet\n\nTo verify the change took place, run the command:\nls -l kubelet\n\nThe kubelet file should now be owned by root:root.","false_positives":"","false_negatives":"","discussion":"The kubelet configuration file contains the runtime configuration of the kubelet service. If an attacker can gain access to this file, changes can be made to open vulnerabilities and bypass user authorizations inherent within Kubernetes with RBAC implemented.","check_content":"On the Kubernetes Control Plane and Worker nodes, run the command:\nps -ef | grep kubelet\n\nCheck the config file (path identified by: --config):\n\nChange to the directory identified by --config (example /etc/sysconfig/) run the command:\nls -l kubelet\n\nEach kubelet configuration file must be owned by root:root.\n\nIf any manifest file is not owned by root:root, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001499"],"group_tree":[{"id":"V-242406","title":"SRG-APP-000133-CTR-000300","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000133-CTR-000300"},{"uuid":"130ecc99-8309-4f75-b4af-7a68bdb7d482","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242407","rule_id":"SV-242407r960960","rule_id_src":"SV-242407r960960_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000890","group_title":"The Kubernetes KubeletConfiguration files must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes KubeletConfiguration files must have file permissions set to 644 or more restrictive.","fix_text":"On the Kubernetes Control Plane and Worker nodes, run the command:\nps -ef | grep kubelet\n\nCheck the config file (path identified by: --config):\n\nChange to the directory identified by --config (example /etc/sysconfig/) and run the command:\nchmod 644 kubelet\n\nTo verify the change took place, run the command:\nls -l kubelet\n\nThe kubelet file should now have the permissions of \"644\".","false_positives":"","false_negatives":"","discussion":"The kubelet configuration file contains the runtime configuration of the kubelet service. If an attacker can gain access to this file, changes can be made to open vulnerabilities and bypass user authorizations inherit within Kubernetes with RBAC implemented.","check_content":" On the Kubernetes Control Plane and Worker nodes, run the command:\nps -ef | grep kubelet\n\nCheck the config file (path identified by: --config):\n\nChange to the directory identified by --config (example /etc/sysconfig/) and run the command:\nls -l kubelet\n\nEach KubeletConfiguration file must have permissions of \"644\" or more restrictive.\n\nIf any KubeletConfiguration file is less restrictive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001499"],"group_tree":[{"id":"V-242407","title":"SRG-APP-000133-CTR-000305","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000133-CTR-000305"},{"uuid":"7235386c-c93f-42b0-84c1-75f080660f09","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242408","rule_id":"SV-242408r960960","rule_id_src":"SV-242408r960960_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000900","group_title":"The Kubernetes manifest files must have least privileges.","rule_title":"The Kubernetes manifest files must have least privileges.","fix_text":"On both Control Plane and Worker Nodes, change to the /etc/kubernetes/manifest directory. Run the command:\nchmod 644 *\n\nTo verify the change took place, run the command:\nls -l *\n\nAll the manifest files should now have privileges of \"644\".","false_positives":"","false_negatives":"","discussion":"The manifest files contain the runtime configuration of the API server, scheduler, controller, and etcd. If an attacker can gain access to these files, changes can be made to open vulnerabilities and bypass user authorizations inherent within Kubernetes with RBAC implemented.\n\nSatisfies: SRG-APP-000133-CTR-000310, SRG-APP-000133-CTR-000295, SRG-APP-000516-CTR-001335","check_content":"On both Control Plane and Worker Nodes, change to the /etc/kubernetes/manifest directory. Run the command:\nls -l *\n\nEach manifest file must have permissions \"644\" or more restrictive.\n\nIf any manifest file is less restrictive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001499","CCI-000366"],"group_tree":[{"id":"V-242408","title":"SRG-APP-000133-CTR-000310","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000133-CTR-000310"},{"uuid":"f5815d69-d59d-4bc6-bbb1-e849c1bcafac","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242409","rule_id":"SV-242409r960963","rule_id_src":"SV-242409r960963_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000910","group_title":"Kubernetes Controller Manager must disable profiling.","rule_title":"Kubernetes Controller Manager must disable profiling.","fix_text":"Edit the Kubernetes Controller Manager manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the argument \"--profiling value\" to \"false\".","false_positives":"","false_negatives":"","discussion":"Kubernetes profiling provides the ability to analyze and troubleshoot Controller Manager events over a web interface on a host port. Enabling this service can expose details about the Kubernetes architecture. This service must not be enabled unless deemed necessary.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i profiling * \n\nIf the setting \"profiling\" is not configured in the Kubernetes Controller Manager manifest file or it is set to \"True\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000381"],"group_tree":[{"id":"V-242409","title":"SRG-APP-000141-CTR-000315","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"kube-controller-manager runs on the AWS-managed EKS control plane; customers can’t set or expose the --profiling flag or its ports. This control is inherited from AWS and out of customer scope. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000141-CTR-000315"},{"uuid":"f56e24df-3fec-4de7-bc24-bf72a9dba5ef","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242410","rule_id":"SV-242410r1043177","rule_id_src":"SV-242410r1043177_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000920","group_title":"The Kubernetes API Server must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","rule_title":"The Kubernetes API Server must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","fix_text":"Amend any system documentation requiring revision to comply with PPSM CAL. \n\nUpdate Kubernetes API Server manifest and namespace PPS configuration to comply with PPSM CAL.","false_positives":"","false_negatives":"","discussion":"Kubernetes API Server PPSs must be controlled and conform to the PPSM CAL. Those PPS that fall outside the PPSM CAL must be blocked. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep kube-apiserver.manifest -I -secure-port *\ngrep kube-apiserver.manifest -I -etcd-servers *\n-edit manifest file:\nVIM <Manifest Name>\nReview livenessProbe:\nHttpGet:\nPort:\nReview ports:\n- containerPort:\nhostPort:\n- containerPort:\nhostPort:\n\nRun command: \nkubectl describe services --all-namespaces \nSearch labels for any apiserver namespaces.\nPort:\n\nAny manifest and namespace PPS or services configuration not in compliance with PPSM CAL is a finding.\n\nReview the information systems documentation and interview the team, gain an understanding of the API Server architecture, and determine applicable PPS. If there are any PPS in the system documentation not in compliance with the CAL PPSM, this is a finding. Any PPS not set in the system documentation is a finding.\n\nReview findings against the most recent PPSM CAL:\nhttps://cyber.mil/ppsm/cal/\n\nVerify API Server network boundary with the PPS associated with the CAL Assurance Categories. Any PPS not in compliance with the CAL Assurance Category requirements is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000382"],"group_tree":[{"id":"V-242410","title":"SRG-APP-000142-CTR-000325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Customers can’t alter API server service ports; EKS exposes only the managed HTTPS endpoint on 443. Customer scope is limited to security groups that allow worker-to-API traffic on 443; all other control-plane service ports are AWS-internal. Link: https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html","srg_id":"SRG-APP-000142-CTR-000325"},{"uuid":"8ebc91a8-76bc-4a62-879f-d709a193dcc3","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242411","rule_id":"SV-242411r1043177","rule_id_src":"SV-242411r1043177_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000930","group_title":"The Kubernetes Scheduler must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","rule_title":"The Kubernetes Scheduler must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","fix_text":"Amend any system documentation requiring revision to comply with the PPSM CAL. \n\nUpdate Kubernetes Scheduler manifest and namespace PPS configuration to comply with the PPSM CAL.","false_positives":"","false_negatives":"","discussion":"Kubernetes Scheduler PPS must be controlled and conform to the PPSM CAL. Those ports, protocols, and services that fall outside the PPSM CAL must be blocked. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep kube-scheduler.manifest -I -insecure-port\n                grep kube-scheduler.manifest -I -secure-port\n-edit manifest file:\nVIM <Manifest Name>\nReview  livenessProbe:\nHttpGet:\nPort:\nReview ports:\n- containerPort:\n       hostPort:\n- containerPort:\n       hostPort:\n\nRun Command: \nkubectl describe services --all-namespaces \nSearch labels for any scheduler namespaces.\nPort:\n\nAny manifest and namespace PPS configuration not in compliance with PPSM CAL is a finding.\n\nReview the information systems documentation and interview the team, gain an understanding of the Scheduler architecture, and determine applicable PPS. Any PPS in the system documentation not in compliance with the CAL PPSM is a finding. Any PPSs not set in the system documentation is a finding.\n\nReview findings against the most recent PPSM CAL:\nhttps://cyber.mil/ppsm/cal/\n\nVerify Scheduler network boundary with the PPS associated with the CAL Assurance Categories. Any PPS not in compliance with the CAL Assurance Category requirements is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000382"],"group_tree":[{"id":"V-242411","title":"SRG-APP-000142-CTR-000325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"kube-controller-manager runs inside the EKS-managed VPC and isn’t customer-reachable; customers can’t expose or change its ports. Customer PPS scope is limited to node SG rules needed for API (443) and kubelet (10250) flows; controller-manager ports are not customer-facing. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000142-CTR-000325"},{"uuid":"901f437d-31d4-4d4b-861a-f49ae6ad97e4","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242412","rule_id":"SV-242412r1043177","rule_id_src":"SV-242412r1043177_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000940","group_title":"The Kubernetes Controllers must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","rule_title":"The Kubernetes Controllers must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","fix_text":"Amend any system documentation requiring revision to comply with the PPSM CAL. \n\nUpdate Kubernetes Controller manifest and namespace PPS configuration to comply with PPSM CAL.","false_positives":"","false_negatives":"","discussion":"Kubernetes Controller ports, protocols, and services must be controlled and conform to the PPSM CAL. Those PPS that fall outside the PPSM CAL must be blocked. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command: \ngrep kube-conntroller-manager.manifest -I -secure-port\n\n-Review manifest file by executing the following:\nVIM <Manifest Name>:\nReview  livenessProbe:\nHttpGet:\nPort:\nReview ports:\n- containerPort:\n       hostPort:\n- containerPort:\n       hostPort:\n\nRun Command: \nkubectl describe services --all-namespaces \nSearch labels for any controller namespaces.\n\nAny manifest and namespace PPS or services configuration not in compliance with PPSM CAL is a finding.\n\nReview the information systems documentation and interview the team, gain an understanding of the Controller architecture, and determine applicable PPS. Any PPS in the system documentation not in compliance with the CAL PPSM is a finding. Any PPS not set in the system documentation is a finding.\n\nReview findings against the most recent PPSM CAL:\nhttps://cyber.mil/ppsm/cal/\n\nVerify Controller network boundary with the PPS associated with the Controller for Assurance Categories. Any PPS not in compliance with the CAL Assurance Category requirements is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000382"],"group_tree":[{"id":"V-242412","title":"SRG-APP-000142-CTR-000330","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"kube-scheduler service ports aren’t customer-visible or configurable in EKS. Required cluster connectivity is restricted to API (443) and control-plane-to-kubelet (10250); scheduler ports remain AWS-internal. Link: https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html","srg_id":"SRG-APP-000142-CTR-000330"},{"uuid":"38df0723-d585-4d60-92ea-8723ecdb05ad","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242413","rule_id":"SV-242413r1043177","rule_id_src":"SV-242413r1043177_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000950","group_title":"The Kubernetes etcd must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","rule_title":"The Kubernetes etcd must enforce ports, protocols, and services (PPS) that adhere to the Ports, Protocols, and Services Management Category Assurance List (PPSM CAL).","fix_text":"Amend any system documentation requiring revision. Update Kubernetes etcd manifest and namespace PPS configuration to comply with PPSM CAL.","false_positives":"","false_negatives":"","discussion":"Kubernetes etcd PPS must be controlled and conform to the PPSM CAL. Those PPS that fall outside the PPSM CAL must be blocked. Instructions on the PPSM can be found in DoD Instruction 8551.01 Policy.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep kube-apiserver.manifest -I -etcd-servers *\n-edit etcd-main.manifest file:\nVIM <Manifest Name:\nReview  livenessProbe:\nHttpGet:\nPort:\nReview ports:\n- containerPort:\n       hostPort:\n- containerPort:\n       hostPort:\nRun Command:\nkubectl describe services –all-namespace\nSearch labels for any apiserver names spaces.\nPort:\n\nAny manifest and namespace PPS configuration not in compliance with PPSM CAL is a finding.\n\nReview the information systems documentation and interview the team, gain an understanding of the etcd architecture, and determine applicable PPS. Any PPS in the system documentation not in compliance with the CAL PPSM is a finding. Any PPS not set in the system documentation is a finding.\n\nReview findings against the most recent PPSM CAL:\nhttps://cyber.mil/ppsm/cal/\n\nVerify etcd network boundary with the PPS associated with the CAL Assurance Categories. Any PPS not in compliance with the CAL Assurance Category requirements is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000382"],"group_tree":[{"id":"V-242413","title":"SRG-APP-000142-CTR-000325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"the etcd cluster runs only inside the EKS-managed VPC; customers can’t access or expose etcd ports. Customer PPS responsibility is limited to node/APIServer security group rules (443 to API, 10250 from control plane to kubelet); etcd ports are not customer-facing. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000142-CTR-000325"},{"uuid":"91038608-c4d3-476b-9983-b77e9dad76a9","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242414","rule_id":"SV-242414r1043177","rule_id_src":"SV-242414r1043177_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-000960","group_title":"The Kubernetes cluster must use non-privileged host ports for user pods.","rule_title":"The Kubernetes cluster must use non-privileged host ports for user pods.","fix_text":"For any of the pods that are using host-privileged ports, reconfigure the pod to use a service to map a host non-privileged port to the pod port or reconfigure the image to use non-privileged ports.","false_positives":"","false_negatives":"","discussion":"Privileged ports are those ports below 1024 and that require system privileges for their use. If containers can use these ports, the container must be run as a privileged user. Kubernetes must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.","check_content":"On the Control Plane, run the command:\nkubectl get pods --all-namespaces\n\nThe list returned is all pods running within the Kubernetes cluster. For those pods running within the user namespaces (System namespaces are kube-system, kube-node-lease and kube-public), run the command:\nkubectl get pod podname -o yaml | grep -i port\n\nNote: In the above command, \"podname\" is the name of the pod. For the command to work correctly, the current context must be changed to the namespace for the pod. The command to do this is:\n\nkubectl config set-context --current --namespace=namespace-name\n(Note: \"namespace-name\" is the name of the namespace.)\n\nReview the ports that are returned for the pod.\n\nIf any host-privileged ports are returned for any of the pods, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000382"],"group_tree":[{"id":"V-242414","title":"SRG-APP-000142-CTR-000330","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000142-CTR-000330"},{"uuid":"a832fe06-8078-4ba2-94b2-cc97ca3b121f","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242415","rule_id":"SV-242415r1069466","rule_id_src":"SV-242415r1069466_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-001160","group_title":"Secrets in Kubernetes must not be stored as environment variables.","rule_title":"Secrets in Kubernetes must not be stored as environment variables.","fix_text":"Any secrets stored as environment variables must be moved to the secret files with the proper protections and enforcements or placed within a password vault.","false_positives":"","false_negatives":"","discussion":"Secrets, such as passwords, keys, tokens, and certificates must not be stored as environment variables. These environment variables are accessible inside Kubernetes by the \"Get Pod\" API call, and by any system, such as CI/CD pipeline, which has access to the definition file of the container. Secrets must be mounted from files or stored within password vaults.","check_content":"Follow these steps to check, from the Kubernetes control plane, if secrets are stored as environment variables.\n\n1. Find All Pods Using Secrets in Environment Variables.\n\nTo list all pods using secrets as environment variables, execute:\n\nkubectl get pods --all-namespaces -o yaml | grep -A5 \"secretKeyRef\"\n\nIf any of the values returned reference environment variables, this is a finding.\n\n2. Check Environment Variables in a Specific Pod.\n\nTo check if a specific pod is using secrets as environment variables, execute:\n\nkubectl get pods -n <namespace>\n(Replace <namespace> with the actual namespace, or omit -n <namespace> to check in the default namespace.)\nkubectl describe pod <pod-name> -n <namespace> | grep -A5 \"Environment:\"\n\nIf secrets are used, output like the following will be displayed:\n\nEnvironment:\n  SECRET_USERNAME:   <set from secret: my-secret key: username>\n  SECRET_PASSWORD:   <set from secret: my-secret key: password>\n\nIf the output is similar to this, the pod is using Kubernetes secrets as environment variables, and this is a finding.\n\n3. Check the Pod YAML for Secret Usage.\n\nTo check the full YAML definition for environment variables, execute:\n\nkubectl get pod <pod-name> -n <namespace> -o yaml | grep -A5 \"env:\"\n\nExample output:\nyaml\nCopyEdit\nenv:\n  - name: SECRET_USERNAME\n    valueFrom:\n      secretKeyRef:\n        name: my-secret\n        key: username\n\nThis means the pod is pulling the secret named my-secret and setting SECRET_USERNAME from its username key.\n\nIf the pod is pulling a secret and setting an environment variable in the \"env:\", this is a finding.\n\n4. Check Secrets in a Deployment, StatefulSet, or DaemonSet.\n\nIf the pod is managed by a Deployment, StatefulSet, or DaemonSet, check their configurations:\n\nkubectl get deployment <deployment-name> -n <namespace> -o yaml | grep -A5 \"env:\"\n\nor\n\nFor all Deployments in all namespaces:\n\nkubectl get deployments --all-namespaces -o yaml | grep -A5 \"env:\"\n\nIf the pod is pulling a secret and setting an environment variable in the \"env:\", this is a finding.\n\n5. Check Environment Variables Inside a Running Pod.\n\nIf needed, check the environment variables inside a running pod:\n\nkubectl exec -it <pod-name> -n <namespace> -- env | grep SECRET\n\nIf any of the values returned reference environment variables, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-004062","CCI-000196"],"group_tree":[{"id":"V-242415","title":"SRG-APP-000171-CTR-000435","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000171-CTR-000435"},{"uuid":"babf07e4-b223-4ec0-8dd0-ee85b1ba3c5f","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242417","rule_id":"SV-242417r961095","rule_id_src":"SV-242417r961095_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001360","group_title":"Kubernetes must separate user functionality.","rule_title":"Kubernetes must separate user functionality.","fix_text":"Move any user pods that are present in the Kubernetes system namespaces to user specific namespaces.","false_positives":"","false_negatives":"","discussion":"Separating user functionality from management functionality is a requirement for all the components within the Kubernetes Control Plane. Without the separation, users may have access to management functions that can degrade the Kubernetes architecture and the services being offered, and can offer a method to bypass testing and validation of functions before introduced into a production environment.","check_content":"On the Control Plane, run the command:\nkubectl get pods --all-namespaces\n\nReview the namespaces and pods that are returned. Kubernetes system namespaces are kube-node-lease, kube-public, and kube-system.\n\nIf any user pods are present in the Kubernetes system namespaces, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001082"],"group_tree":[{"id":"V-242417","title":"SRG-APP-000211-CTR-000530","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000211-CTR-000530"},{"uuid":"01f1bf53-3f6f-420b-b576-967e949db578","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242418","rule_id":"SV-242418r1043178","rule_id_src":"SV-242418r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001400","group_title":"The Kubernetes API server must use approved cipher suites.","rule_title":"The Kubernetes API server must use approved cipher suites.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--tls-cipher-suites\" to:\n\"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\"","false_positives":"","false_negatives":"","discussion":"The Kubernetes API server communicates to the kubelet service on the nodes to deploy, update, and delete resources. If an attacker were able to get between this communication and modify the request, the Kubernetes cluster could be compromised. Using approved cypher suites for the communication ensures the protection of the transmitted information, confidentiality, and integrity so that the attacker cannot read or alter this communication.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i tls-cipher-suites *\n\nIf the setting feature tls-cipher-suites is not set in the Kubernetes API server manifest file or contains no value or does not contain TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242418","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Amazon EKS runs the kube-apiserver on an AWS-managed control plane; customers cannot set --tls-cipher-suites. EKS API endpoints are AWS service endpoints that require TLS 1.2 (TLS 1.3 recommended) and are managed by AWS; cipher selection is enforced by AWS for the service, not configurable by customers. This satisfies the STIG intent to allow only approved/strong ciphers on the control plane. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html\n https://aws.amazon.com/blogs/security/tls-1-2-required-for-aws-endpoints/","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"113d0b95-353f-4b35-b321-502c958c96a0","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242419","rule_id":"SV-242419r1043178","rule_id_src":"SV-242419r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001410","group_title":"Kubernetes API Server must have the SSL Certificate Authority set.","rule_title":"Kubernetes API Server must have the SSL Certificate Authority set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--client-ca-file\" to path containing Approved Organizational Certificate.","false_positives":"","false_negatives":"","discussion":"Kubernetes control plane and external communication are managed by API Server. The main implementation of the API Server is to manage hardware resources for pods and containers using horizontal or vertical scaling. Anyone who can access the API Server can effectively control the Kubernetes architecture. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols such as TLS. TLS provides the Kubernetes API Server with a means to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for API Server, the parameter client-ca-file must be set. This parameter gives the location of the SSL Certificate Authority file used to secure API Server communication.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i client-ca-file *\n\nIf the setting feature client-ca-file is not set in the Kubernetes API server manifest file or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242419","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the Kubernetes API server is part of the AWS-managed control plane, so customers can’t set flags like --client-ca-file. The control is inherited from AWS’s operation of the control plane. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"1da20809-7e19-42c0-84eb-710d270c6104","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242420","rule_id":"SV-242420r1043178","rule_id_src":"SV-242420r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001420","group_title":"Kubernetes Kubelet must have the SSL Certificate Authority set.","rule_title":"Kubernetes Kubelet must have the SSL Certificate Authority set.","fix_text":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"--client-ca-file\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the Kubernetes Kubelet config file: \nSet the value of \"clientCAFile\" to a path containing an Approved Organizational Certificate. \n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubernetes container and pod configuration are maintained by Kubelet. Kubelet agents register nodes with the API Server, mount volume storage, and perform health checks for containers and pods. Anyone who gains access to Kubelet agents can effectively control applications within the pods and containers. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols such as TLS. TLS provides the Kubernetes API Server with a means to authenticate sessions and encrypt traffic.\n\nTo enable encrypted communication for Kubelet, the clientCAFile must be set. This parameter gives the location of the SSL Certificate Authority file used to secure Kubelet communication.","check_content":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nIf the \"--client-ca-file\" option exists, this is a finding.\n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i clientCAFile <path_to_config_file>\n\nIf the setting \"clientCAFile\" is not set or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242420","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"On Amazon EKS, the control plane is AWS-managed. The cluster’s certificate authority is exposed via the EKS API and is what clients (kubectl/kubelet) trust for the API server. We verify the CA by checking certificateAuthority.data from describe-cluster (non-empty, base64-encoded PEM). Link: https://docs.aws.amazon.com/cli/latest/reference/eks/describe-cluster.html","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"e97142bd-397f-42b7-bcc1-30100ff0f7b9","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242421","rule_id":"SV-242421r1043178","rule_id_src":"SV-242421r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001430","group_title":"Kubernetes Controller Manager must have the SSL Certificate Authority set.","rule_title":"Kubernetes Controller Manager must have the SSL Certificate Authority set.","fix_text":"Edit the Kubernetes Controller Manager manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--root-ca-file\" to path containing Approved Organizational Certificate.","false_positives":"","false_negatives":"","discussion":"The Kubernetes Controller Manager is responsible for creating service accounts and tokens for the API Server, maintaining the correct number of pods for every replication controller and provides notifications when nodes are offline.  \n\nAnyone who gains access to the Controller Manager can generate backdoor accounts, take possession of, or diminish system performance without detection by disabling system notification. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes Controller Manager with a means to be able to authenticate sessions and encrypt traffic.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i root-ca-file *\n\nIf the setting \"--root-ca-file\" is not set in the Kubernetes Controller Manager manifest file or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242421","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the kube-controller-manager runs on the AWS-managed control plane; customers can’t set --root-ca-file. The control is inherited from AWS’s operation of the control plane. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"a97c8bd3-4675-4ea2-89d4-9c10b5d35b62","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242422","rule_id":"SV-242422r1043178","rule_id_src":"SV-242422r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001440","group_title":"Kubernetes API Server must have a certificate for communication.","rule_title":"Kubernetes API Server must have a certificate for communication.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of tls-cert-file and tls-private-key-file to path containing Approved Organizational Certificate.","false_positives":"","false_negatives":"","discussion":"Kubernetes control plane and external communication is managed by API Server. The main implementation of the API Server is to manage hardware resources for pods and container using horizontal or vertical scaling. Anyone who can access the API Server can effectively control the Kubernetes architecture. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for API Server, the parameter etcd-cafile must be set. This parameter gives the location of the SSL Certificate Authority file used to secure API Server communication.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i tls-cert-file *\ngrep -i tls-private-key-file *\n\nIf the setting tls-cert-file and private-key-file is not set in the Kubernetes API server manifest file or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242422","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"The EKS Kubernetes API server is AWS-managed; customers cannot set --tls-cert-file/--tls-private-key-file. EKS presents a managed HTTPS endpoint backed by AWS-managed certificates, and the cluster’s CA is exposed via describe-cluster for clients, satisfying the requirement. Link: https://docs.aws.amazon.com/eks/latest/userguide/infrastructure-security.html","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"cfe963b2-2244-425b-8b0d-581c420e7413","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242423","rule_id":"SV-242423r1043178","rule_id_src":"SV-242423r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001450","group_title":"Kubernetes etcd must enable client authentication to secure service.","rule_title":"Kubernetes etcd must enable client authentication to secure service.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--client-cert-auth\" to \"true\" for the etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes container and pod configuration are maintained by Kubelet. Kubelet agents register nodes with the API Server, mount volume storage, and perform health checks for containers and pods. Anyone who gains access to Kubelet agents can effectively control applications within the pods and containers. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server with a means to be able to authenticate sessions and encrypt traffic.\n\nTo enable encrypted communication for Kubelet, the parameter client-cert-auth must be set. This parameter gives the location of the SSL Certificate Authority file used to secure Kubelet communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\ngrep -i client-cert-auth * \n\nIf the setting client-cert-auth is not configured in the Kubernetes etcd manifest file or set to \"false\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242423","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the Kubernetes control plane (including etcd) is fully AWS-managed. Customers can’t set --client-cert-auth on etcd; AWS is responsible for enforcing TLS client auth for control-plane components. Mark as Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"b2764511-a8d7-4f51-a2be-bfc86a77d2f7","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242424","rule_id":"SV-242424r1043178","rule_id_src":"SV-242424r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001460","group_title":"Kubernetes Kubelet must enable tlsPrivateKeyFile for client authentication to secure service.","rule_title":"Kubernetes Kubelet must enable tlsPrivateKeyFile for client authentication to secure service.","fix_text":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"--tls-private-key-file\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the Kubernetes Kubelet config file: \nSet \"tlsPrivateKeyFile\" to  a path containing the appropriate private key. \n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubernetes container and pod configuration are maintained by Kubelet. Kubelet agents register nodes with the API Server, mount volume storage, and perform health checks for containers and pods. Anyone who gains access to Kubelet agents can effectively control applications within the pods and containers. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols such as TLS. TLS provides the Kubernetes API Server with a means to authenticate sessions and encrypt traffic.\n\nTo enable encrypted communication for Kubelet, the tlsPrivateKeyFile must be set. This parameter gives the location of the SSL Certificate Authority file used to secure Kubelet communication.","check_content":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nIf the \"--tls-private-key-file\" option exists, this is a finding. \n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i tlsPrivateKeyFile <path_to_config_file>\n\nIf the setting \"tlsPrivateKeyFile\" is not set or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242424","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"4cfe40ff-3953-47c9-b3dc-77030fc9b04d","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242425","rule_id":"SV-242425r1043178","rule_id_src":"SV-242425r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001470","group_title":"Kubernetes Kubelet must enable tlsCertFile for client authentication to secure service.","rule_title":"Kubernetes Kubelet must enable tlsCertFile for client authentication to secure service.","fix_text":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"--tls-cert-file\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the Kubernetes Kubelet config file: \nSet \"tlsCertFile\" to a path containing an Approved Organization Certificate. \n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"Kubernetes container and pod configuration are maintained by Kubelet. Kubelet agents register nodes with the API Server, mount volume storage, and perform health checks for containers and pods. Anyone who gains access to Kubelet agents can effectively control applications within the pods and containers. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols such as TLS. TLS provides the Kubernetes API Server with a means to authenticate sessions and encrypt traffic.\n\nTo enable encrypted communication for Kubelet, the parameter tlsCertFile must be set. This parameter gives the location of the SSL Certificate Authority file used to secure Kubelet communication.","check_content":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nIf the argument for \"--tls-cert-file\" option exists, this is a finding. \n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i tlsCertFile <path_to_config_file>\n\nIf the setting \"tlsCertFile\" is not set or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242425","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"f7da3bec-4b34-458b-b9f1-2b144a209a22","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242426","rule_id":"SV-242426r1043178","rule_id_src":"SV-242426r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001480","group_title":"Kubernetes etcd must enable client authentication to secure service.","rule_title":"Kubernetes etcd must enable client authentication to secure service.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane.\n\nSet the value of \"--peer-client-cert-auth\" to \"true\" for the etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes container and pod configuration are maintained by Kubelet. Kubelet agents register nodes with the API Server, mount volume storage, and perform health checks for containers and pods. Anyone who gains access to Kubelet agents can effectively control applications within the pods and containers. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server with a means to be able to authenticate sessions and encrypt traffic.\n\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive and should be accessible only by authenticated etcd peers in the etcd cluster. The parameter \"--peer-client-cert-auth\" must be set for etcd to check all incoming peer requests from the cluster for valid client certificates.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i peer-client-cert-auth * \n\nIf the setting \"--peer-client-cert-auth\" is not configured in the Kubernetes etcd manifest file or set to \"false\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242426","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"EKS manages etcd and its peer auth configuration; customers can’t alter --peer-client-cert-auth. Mark as Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"67c647f0-3b23-411d-afa0-4f9ab566057a","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242427","rule_id":"SV-242427r1043178","rule_id_src":"SV-242427r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001490","group_title":"Kubernetes etcd must have a key file for secure communication.","rule_title":"Kubernetes etcd must have a key file for secure communication.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--key-file\" to the Approved Organizational Certificate.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control the Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter key-file must be set. This parameter gives the location of the key file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nRun the command:\n    grep -i key-file *\n\nIf the setting \"key-file\" is not configured in the etcd manifest  file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242427","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"The etcd server key file configuration is managed by AWS in EKS control plane nodes; customers cannot set or read it. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"fee7c221-8081-4296-b857-cde36c666b48","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242428","rule_id":"SV-242428r1043178","rule_id_src":"SV-242428r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001500","group_title":"Kubernetes etcd must have a certificate for communication.","rule_title":"Kubernetes etcd must have a certificate for communication.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--cert-file\" to the Approved Organizational Certificate.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control a Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter cert-file must be set. This parameter gives the location of the SSL certification file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i cert-file * \n\nIf the setting \"cert-file\" is not configured in the Kubernetes etcd manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242428","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"The etcd certificate file is configured by AWS on control plane; not customer-configurable in EKS. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"7927ed61-3473-420e-8c30-c3c7d903c9ac","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242429","rule_id":"SV-242429r1043178","rule_id_src":"SV-242429r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001510","group_title":"Kubernetes etcd must have the SSL Certificate Authority set.","rule_title":"Kubernetes etcd must have the SSL Certificate Authority set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--etcd-cafile\" to the Certificate Authority for etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control a Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter \"--etcd-cafile\" must be set. This parameter gives the location of the SSL Certificate Authority file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i etcd-cafile * \n\nIf the setting \"--etcd-cafile\" is not configured in the Kubernetes API Server manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242429","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the etcd cluster is part of the AWS-managed control plane; customers can’t set --etcd-cafile. The control is inherited from AWS’s operation of the control plane. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"b046c26e-f78c-4190-af4e-9915fc8d4ae7","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242430","rule_id":"SV-242430r1043178","rule_id_src":"SV-242430r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001520","group_title":"Kubernetes etcd must have a certificate for communication.","rule_title":"Kubernetes etcd must have a certificate for communication.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--etcd-certfile\" to the certificate to be used for communication with etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control the Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter \"--etcd-certfile\" must be set. This parameter gives the location of the SSL certification file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i etcd-certfile * \n\nIf the setting \"--etcd-certfile\" is not set in the Kubernetes API Server manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242430","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"API server ↔ etcd TLS settings (including --etcd-certfile) are managed by AWS in EKS; customers can’t view or change the manifest flags.","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"02a51aa5-2605-4c96-80c1-f65ec505c825","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242431","rule_id":"SV-242431r1043178","rule_id_src":"SV-242431r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001530","group_title":"Kubernetes etcd must have a key file for secure communication.","rule_title":"Kubernetes etcd must have a key file for secure communication.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--etcd-keyfile\" to the certificate to be used for communication with etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control a Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter \"--etcd-keyfile\" must be set. This parameter gives the location of the key file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i etcd-keyfile * \n\nIf the setting \"--etcd-keyfile\" is not configured in the Kubernetes API Server manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242431","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"API server ↔ etcd TLS settings (including --etcd-certfile) are managed by AWS in EKS; customers can’t view or change the manifest flags.","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"b7cb75fb-c93b-4684-94de-1cdbb9b34532","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242432","rule_id":"SV-242432r1043178","rule_id_src":"SV-242432r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001540","group_title":"Kubernetes etcd must have peer-cert-file set for secure communication.","rule_title":"Kubernetes etcd must have peer-cert-file set for secure communication.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--peer-cert-file\" to the certificate to be used for communication with etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control the Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter peer-cert-file must be set. This parameter gives the location of the SSL certification file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i peer-cert-file * \n\nIf the setting \"peer-cert-file\" is not configured in the Kubernetes etcd manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242432","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"etcd peer key config is part of the managed control plane and not exposed in EKS. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"28086cb2-8222-4dca-b513-b2c94c31953e","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242433","rule_id":"SV-242433r1043178","rule_id_src":"SV-242433r1043178_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001550","group_title":"Kubernetes etcd must have a peer-key-file set for secure communication.","rule_title":"Kubernetes etcd must have a peer-key-file set for secure communication.","fix_text":"Edit the Kubernetes etcd manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--peer-key-file\" to the certificate to be used for communication with etcd.","false_positives":"","false_negatives":"","discussion":"Kubernetes stores configuration and state information in a distributed key-value store called etcd. Anyone who can write to etcd can effectively control a Kubernetes cluster. Even just reading the contents of etcd could easily provide helpful hints to a would-be attacker. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server and etcd with a means to be able to authenticate sessions and encrypt traffic. \n\nTo enable encrypted communication for etcd, the parameter peer-key-file must be set. This parameter gives the location of the SSL certification file used to secure etcd communication.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i peer-key-file *\n\nIf the setting \"peer-key-file\" is not set in the Kubernetes etcd manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001184"],"group_tree":[{"id":"V-242433","title":"SRG-APP-000219-CTR-000550","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"etcd peer key config is part of the managed control plane and not exposed in EKS. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000219-CTR-000550"},{"uuid":"3df897c3-b622-4fcc-9152-452b86cbcfe1","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242434","rule_id":"SV-242434r961131","rule_id_src":"SV-242434r961131_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-001620","group_title":"Kubernetes Kubelet must enable kernel protection.","rule_title":"Kubernetes Kubelet must enable kernel protection.","fix_text":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"--protect-kernel-defaults\" option if present.\n\nNote the path to the Kubernetes Kubelet config file (identified by --config).\n\nEdit the Kubernetes Kubelet config file: \nSet \"protectKernelDefaults\" to \"true\". \n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"System kernel is responsible for memory, disk, and task management. The kernel provides a gateway between the system hardware and software. Kubernetes requires kernel access to allocate resources to the Control Plane. Threat actors that penetrate the system kernel can inject malicious code or hijack the Kubernetes architecture. It is vital to implement protections through Kubernetes components to reduce the attack surface.","check_content":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nIf the \"--protect-kernel-defaults\" option exists, this is a finding.\n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i protectKernelDefaults <path_to_config_file>\n\nIf the setting \"protectKernelDefaults\" is not set or is set to false, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001084"],"group_tree":[{"id":"V-242434","title":"SRG-APP-000233-CTR-000585","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"In Amazon EKS, the Kubernetes control plane (API server, controller-manager, scheduler, etcd) is AWS-managed; customers can’t access or set control-plane flags/manifests. This requirement is inherited from AWS and out of customer scope. Link: https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000233-CTR-000585"},{"uuid":"da454d70-f8b0-4d01-8b60-28c7ae5b11d4","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242436","rule_id":"SV-242436r961359","rule_id_src":"SV-242436r961359_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002000","group_title":"The Kubernetes API server must have the ValidatingAdmissionWebhook enabled.","rule_title":"The Kubernetes API server must have the ValidatingAdmissionWebhook enabled.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the argument \"--enable-admission-plugins\" to include \"ValidatingAdmissionWebhook\".  Each enabled plugin is separated by commas.\n\nNote: It is best to implement policies first and then enable the webhook, otherwise a denial of service may occur.","false_positives":"","false_negatives":"","discussion":"Enabling the admissions webhook allows for Kubernetes to apply policies against objects that are to be created, read, updated, or deleted. By applying a pod security policy, control can be given to not allow images to be instantiated that run as the root user. If pods run as the root user, the pod then has root privileges to the host system and all the resources it has. An attacker can use this to attack the Kubernetes cluster. By implementing a policy that does not allow root or privileged pods, the pod users are limited in what the pod can do and access.","check_content":"Prior to version 1.21, to enforce security policiesPod Security Policies (psp) were used. Those are now deprecated and will be removed from version 1.25.\n\nMigrate from PSP to PSA:\nhttps://kubernetes.io/docs/tasks/configure-pod-container/migrate-from-psp/ \n\nPre-version 1.25 Check:\nChange to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i ValidatingAdmissionWebhook * \n\nIf a line is not returned that includes enable-admission-plugins and ValidatingAdmissionWebhook, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002263"],"group_tree":[{"id":"V-242436","title":"SRG-APP-000342-CTR-000775","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control plane flag; in Amazon EKS this admission controller is enabled by default and API server flags aren’t customer-tunable. Not a finding for customers to remediate; cite AWS’s statement that EKS enables Validating/MutatingAdmissionWebhook by default on supported versions. https://repost.aws/knowledge-center/eks-enable-webhook-admission-controller","srg_id":"SRG-APP-000342-CTR-000775"},{"uuid":"237e3667-6c98-40cb-b782-5ee214ebe440","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242437","rule_id":"SV-242437r961359","rule_id_src":"SV-242437r961359_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002010","group_title":"Kubernetes must have a pod security policy set.","rule_title":"Kubernetes must have a pod security policy set.","fix_text":"From the Control Plane, save the following policy to a file called restricted.yml.\n\napiVersion: policy/v1beta1\nkind: PodSecurityPolicy\nmetadata:\nname: restricted\nannotations:\napparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default',\nseccomp.security.alpha.kubernetes.io/defaultProfileName: 'runtime/default',\napparmor.security.beta.kubernetes.io/defaultProfileName: 'runtime/default'\nspec:\nprivileged: false\n# Required to prevent escalations to root.\nallowPrivilegeEscalation: false\n# This is redundant with non-root + disallow privilege escalation,\n# but we can provide it for defense in depth.\nrequiredDropCapabilities:\n- ALL\n# Allow core volume types.\nvolumes:\n- 'configMap'\n- 'emptyDir'\n- 'projected'\n- 'secret'\n- 'downwardAPI'\n# Assume that persistentVolumes set up by the cluster admin are safe to use.\n- 'persistentVolumeClaim'\nhostNetwork: false\nhostIPC: false\nhostPID: false\nrunAsUser:\n# Require the container to run without root privileges.\nrule: 'MustRunAsNonRoot'\nseLinux:\n# This policy assumes the nodes are using AppArmor rather than SELinux.\nrule: 'RunAsAny'\nsupplementalGroups:\nrule: 'MustRunAs'\nranges:\n# Forbid adding the root group.\n- min: 1\nmax: 65535\nfsGroup:\nrule: 'MustRunAs'\nranges:\n# Forbid adding the root group.\n- min: 1\nmax: 65535\nreadOnlyRootFilesystem: false\n\nTo implement the policy, run the command:\nkubectl create -f restricted.yml","false_positives":"","false_negatives":"","discussion":"Enabling the admissions webhook allows for Kubernetes to apply policies against objects that are to be created, read, updated, or deleted. By applying a pod security policy, control can be given to not allow images to be instantiated that run as the root user. If pods run as the root user, the pod then has root privileges to the host system and all the resources it has. An attacker can use this to attack the Kubernetes cluster. By implementing a policy that does not allow root or privileged pods, the pod users are limited in what the pod can do and access.","check_content":"Prior to version 1.21, to enforce security policiesPod Security Policies (psp) were used. Those are now deprecated and will be removed from version 1.25.\n\nMigrate from PSP to PSA:\nhttps://kubernetes.io/docs/tasks/configure-pod-container/migrate-from-psp/ \n\nPre-version 1.25 Check:\nOn the Control Plane, run the command:\nkubectl get podsecuritypolicy\n\nIf there is no pod security policy configured, this is a finding. \n\nFor any pod security policies listed, edit the policy with the command:\nkubectl edit podsecuritypolicy policyname\n(Note: \"policyname\" is the name of the policy.)\n\nReview the runAsUser, supplementalGroups and fsGroup sections of the policy.\n\nIf any of these sections are missing, this is a finding.\n\nIf the rule within the runAsUser section is not set to \"MustRunAsNonRoot\", this is a finding.\n\nIf the ranges within the supplementalGroups section has min set to \"0\" or min is missing, this is a finding.\n\nIf the ranges within the fsGroup section has a min set to \"0\" or the min is missing, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002263"],"group_tree":[{"id":"V-242437","title":"SRG-APP-000342-CTR-000775","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000342-CTR-000775"},{"uuid":"a758cf52-fe7e-4ca8-ac80-9593c8daad71","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242438","rule_id":"SV-242438r961620","rule_id_src":"SV-242438r961620_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-002600","group_title":"Kubernetes API Server must configure timeouts to limit attack surface.","rule_title":"Kubernetes API Server must configure timeouts to limit attack surface.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--request-timeout\" greater than \"0\".","false_positives":"","false_negatives":"","discussion":"Kubernetes API Server request timeouts sets the duration a request stays open before timing out. Since the API Server is the central component in the Kubernetes Control Plane, it is vital to protect this service. If request timeouts were not set, malicious attacks or unwanted activities might affect multiple deployments across different applications or environments. This might deplete all resources from the Kubernetes infrastructure causing the information system to go offline. The \"--request-timeout\" value must never be set to \"0\". This disables the request-timeout feature. (By default, the \"--request-timeout\" is set to \"1 minute\".)","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -I request-timeout * \n\nIf Kubernetes API Server manifest file does not exist, this is a finding. \n\nIf the setting \"--request-timeout\" is set to \"0\" in the Kubernetes API Server manifest file, or is not configured this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002415"],"group_tree":[{"id":"V-242438","title":"SRG-APP-000435-CTR-001070","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control plane flag; EKS manages the API server and does not expose this flag. Customers can’t change /etc/kubernetes/manifests/kube-apiserver.yaml. Treat as “provider-managed; not customer-configurable” (not a finding for you). https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000435-CTR-001070"},{"uuid":"e435bbfb-3545-4372-b328-87235a7ed366","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242442","rule_id":"SV-242442r961677","rule_id_src":"SV-242442r961677_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-002700","group_title":"Kubernetes must remove old components after updated versions have been installed.","rule_title":"Kubernetes must remove old components after updated versions have been installed.","fix_text":"Remove any old pods that are using older images. On the Control Plane, run the command:\nkubectl delete pod podname\n(Note: \"podname\" is the name of the pod to delete.)","false_positives":"","false_negatives":"","discussion":"Previous versions of Kubernetes components that are not removed after updates have been installed may be exploited by adversaries by allowing the vulnerabilities to still exist within the cluster. It is important for Kubernetes to remove old pods when newer pods are created using new images to always be at the desired security state.","check_content":"To view all pods and the images used to create the pods, from the Control Plane, run the following command:\nkubectl get pods --all-namespaces -o jsonpath=\"{..image}\" | \\\ntr -s '[[:space:]]' '\\n' | \\\nsort | \\\nuniq -c\n\nReview the images used for pods running within Kubernetes.\n\nIf there are multiple versions of the same image, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002647"],"group_tree":[{"id":"V-242442","title":"SRG-APP-000454-CTR-001110","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000454-CTR-001110"},{"uuid":"a8b0a2cf-3c61-4969-83b9-b40722df9bf9","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242443","rule_id":"SV-242443r961683","rule_id_src":"SV-242443r961683_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-002720","group_title":"Kubernetes must contain the latest updates as authorized by IAVMs, CTOs, DTMs, and STIGs.","rule_title":"Kubernetes must contain the latest updates as authorized by IAVMs, CTOs, DTMs, and STIGs.","fix_text":"Upgrade Kubernetes to the supported version. Institute and adhere to the policies and procedures to ensure that patches are consistently applied within the time allowed.","false_positives":"","false_negatives":"","discussion":"Kubernetes software must stay up to date with the latest patches, service packs, and hot fixes. Not updating the Kubernetes control plane will expose the organization to vulnerabilities.\n\nFlaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. \n\nOrganization-defined time periods for updating security-relevant container platform components may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). \n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the IAVM process.\n\nThe container platform components will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The container platform registry will ensure the images are current. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","check_content":"Authenticate on the Kubernetes Control Plane. Run the command:\nkubectl version --short\n\nIf kubectl version has a setting not supporting Kubernetes skew policy, this is a finding.\n\nNote: Kubernetes Skew Policy can be found at: https://kubernetes.io/docs/setup/release/version-skew-policy/#supported-versions","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002635"],"group_tree":[{"id":"V-242443","title":"SRG-APP-000456-CTR-001125","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"API","finding_details":"Shared: EKS manages control plane binaries, but you choose the supported Kubernetes minor version and must keep clusters within EKS support windows and upgrade nodes/add-ons. Justify with EKS version lifecycle and upgrade docs. https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html\n ; https://docs.aws.amazon.com/eks/latest/userguide/update-cluster.html\n\nPrint the version of the AWS EKS Cluster version and make manual check to make sure that Kubectl is within skew version +-1 minor version.\n\nI'm not running kubectl on any of the Worker nodes...","srg_id":"SRG-APP-000456-CTR-001125"},{"uuid":"d89b25e7-bcea-48f4-8b47-b5e55fdaa2e9","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242444","rule_id":"SV-242444r961863","rule_id_src":"SV-242444r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003110","group_title":"The Kubernetes component manifests must be owned by root.","rule_title":"The Kubernetes component manifests must be owned by root.","fix_text":"Change the ownership of the manifest files to root: root by executing the command:\n\nchown root:root /etc/kubernetes/manifests/*","false_positives":"","false_negatives":"","discussion":"The Kubernetes manifests are those files that contain the arguments and settings for the Control Plane services. These services are etcd, the api server, controller, proxy, and scheduler. If these files can be changed, the scheduler will be implementing the changes immediately. Many of the security settings within the document are implemented through these manifests.","check_content":"Review the ownership of the Kubernetes manifests files by using the command:\n\nstat -c %U:%G /etc/kubernetes/manifests/* | grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242444","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control-plane manifests live on AWS-managed hosts (not customer accessible); AWS ensures ownership and permissions. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"0d5a6369-8cc8-403b-b91a-c51f2158c3e8","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242445","rule_id":"SV-242445r961863","rule_id_src":"SV-242445r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003120","group_title":"The Kubernetes component etcd must be owned by etcd.","rule_title":"The Kubernetes component etcd must be owned by etcd.","fix_text":"Change the ownership of the manifest files to etcd:etcd by executing the command:\n\nchown etcd:etcd /var/lib/etcd/*","false_positives":"","false_negatives":"","discussion":"The Kubernetes etcd key-value store provides a way to store data to the Control Plane. If these files can be changed, data to API object and the Control Plane would be compromised. The scheduler will implement the changes immediately. Many of the security settings within the document are implemented through this file.","check_content":"Review the ownership of the Kubernetes etcd files by using the command:\n\nstat -c %U:%G /var/lib/etcd/* | grep -v etcd:etcd\n\nIf the command returns any non etcd:etcd file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242445","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"etcd data and config ownership on control-plane nodes is AWS-managed in EKS. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"8255ac58-dca7-4cdc-8cbe-15a66951ccae","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242446","rule_id":"SV-242446r961863","rule_id_src":"SV-242446r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003130","group_title":"The Kubernetes conf files must be owned by root.","rule_title":"The Kubernetes conf files must be owned by root.","fix_text":"Change the ownership of the conf files to root: root by executing the command:\n\nchown root:root /etc/kubernetes/admin.conf \nchown root:root /etc/kubernetes/scheduler.conf \nchown root:root /etc/kubernetes/controller-manager.conf","false_positives":"","false_negatives":"","discussion":"The Kubernetes conf files contain the arguments and settings for the Control Plane services. These services are controller and scheduler. If these files can be changed, the scheduler will be implementing the changes immediately. Many of the security settings within the document are implemented through this file.","check_content":"Review the Kubernetes conf files by using the command:\n\nstat -c %U:%G /etc/kubernetes/admin.conf | grep -v root:root\nstat -c %U:%G /etc/kubernetes/scheduler.conf | grep -v root:root\nstat -c %U:%G /etc/kubernetes/controller-manager.conf | grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242446","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"These files live on control plane hosts (/etc/kubernetes/{controller-manager.conf,scheduler.conf}) which are not accessible in EKS. EKS manages ownership/permissions; customers can’t modify or inspect. Mark as provider-managed, not customer-configurable. https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"6c17dcbf-28d7-4512-bc5c-8c289ef12d64","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242447","rule_id":"SV-242447r961863","rule_id_src":"SV-242447r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003140","group_title":"The Kubernetes Kube Proxy kubeconfig must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes Kube Proxy kubeconfig must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of the Kube Proxy to \"644\" by executing the command:\n\nchmod 644 <location from kubeconfig>.","false_positives":"","false_negatives":"","discussion":"The Kubernetes Kube Proxy kubeconfig contain the argument and setting for the Control Planes. These settings contain network rules for restricting network communication between pods, clusters, and networks. If these files can be changed, data traversing between the Kubernetes Control Panel components would be compromised. Many of the security settings within the document are implemented through this file.","check_content":"Check if Kube-Proxy is running and obtain --kubeconfig parameter use the following command:\nps -ef | grep kube-proxy\n\nIf Kube-Proxy exists:\nReview the permissions of the Kubernetes Kube Proxy by using the command:\nstat -c %a <location from --kubeconfig>\n\nIf the file has permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242447","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"a247b83f-690d-42b7-8c2b-4ecdf05ffbd6","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242448","rule_id":"SV-242448r961863","rule_id_src":"SV-242448r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003150","group_title":"The Kubernetes Kube Proxy kubeconfig must be owned by root.","rule_title":"The Kubernetes Kube Proxy kubeconfig must be owned by root.","fix_text":"Change the ownership of the Kube Proxy to root:root by executing the command:\n\nchown root:root <location from kubeconfig>.","false_positives":"","false_negatives":"","discussion":"The Kubernetes Kube Proxy kubeconfig contain the argument and setting for the Control Planes. These settings contain network rules for restricting network communication between pods, clusters, and networks. If these files can be changed, data traversing between the Kubernetes Control Panel components would be compromised. Many of the security settings within the document are implemented through this file.","check_content":"Check if Kube-Proxy is running use the following command:\nps -ef | grep kube-proxy\n\nIf Kube-Proxy exists:\nReview the permissions of the Kubernetes Kube Proxy by using the command:\nstat -c   %U:%G <location from --kubeconfig>| grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242448","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"5477f7cd-3e32-4f96-94a9-986b9b8aebbe","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242449","rule_id":"SV-242449r961863","rule_id_src":"SV-242449r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003160","group_title":"The Kubernetes Kubelet certificate authority file must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes Kubelet certificate authority file must have file permissions set to 644 or more restrictive.","fix_text":"On the Control Plane, run the command:\r\nps -ef | grep kubelet\r\n\r\nRemove the \"--client-ca-file\" option.\r\n\r\nNote the path to the config file (identified by --config).\r\n\r\nRun the command:\r\ngrep -i clientCAFile <path_to_config_file>\r\n\r\nNote the path to the client ca file.\r\n\r\nRun the command:\r\nchmod 644 <path_to_client_ca_file>","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubelet certificate authority file contains settings for the Kubernetes Node TLS certificate authority. Any request presenting a client certificate signed by one of the authorities in the client-ca-file is authenticated with an identity corresponding to the CommonName of the client certificate. If this file can be changed, the Kubernetes architecture could be compromised. The scheduler will implement the changes immediately. Many of the security settings within the document are implemented through this file.","check_content":"On the Control Plane, run the command:\r\nps -ef | grep kubelet\r\n\r\nIf the \"--client-ca-file\" option exists, this is a finding. \r\n\r\nNote the path to the config file (identified by --config).\r\n\r\nRun the command:\r\ngrep -i clientCAFile <path_to_config_file>\r\n\r\nNote the path to the client ca file.\r\n\r\nRun the command:\r\nstat -c %a <path_to_client_ca_file>\r\n\r\nIf the client ca file has permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242449","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Node-level. Validate the kubelet clientCAFile path in your kubelet config, then verify mode ≤ 0644 on AL2023 and Windows file ACL equivalent. Kubelet config paths: AL2023 /etc/kubernetes/kubelet/kubelet-config.{json|yaml}, Windows C:\\var\\lib\\kubelet\\config.yaml. Source for the control intent: STIG text. https://stigviewer.com/stigs/kubernetes/2024-06-10/finding/V-242449","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"5646811c-c895-46e1-bac1-3bc1bf26a776","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242450","rule_id":"SV-242450r961863","rule_id_src":"SV-242450r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003170","group_title":"The Kubernetes Kubelet certificate authority must be owned by root.","rule_title":"The Kubernetes Kubelet certificate authority must be owned by root.","fix_text":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"client-ca-file\" option.\n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i clientCAFile <path_to_config_file>\n\nNote the path to the client ca file.\n\nRun the command:\nchown root:root <path_to_client_ca_file>","false_positives":"","false_negatives":"","discussion":"The Kubernetes kube proxy kubeconfig contain the argument and setting for the Control Planes. These settings contain network rules for restricting network communication between pods, clusters, and networks. If these files can be changed, data traversing between the Kubernetes Control Panel components would be compromised. Many of the security settings within the document are implemented through this file.","check_content":"On the Control Plane, run the command:\nps -ef | grep kubelet\n\nIf the \"client-ca-file\" option exists, this is a finding. \n\nNote the path to the config file (identified by --config).\n\nRun the command:\ngrep -i clientCAFile <path_to_config_file>\n\nNote the path to the client ca file.\n\nRun the command:\nstat -c %U:%G <path_to_client_ca_file>\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242450","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"On Amazon EKS, the client CA used by the API server is part of the AWS-managed control plane; customers can’t access or modify the CA file or its ownership on control-plane hosts. The cluster’s CA is exposed read-only via the EKS API/console as certificateAuthority.data and is what clients (kubectl/kubelet) use in kubeconfig. Not a finding – AWS responsibility. Links: https://docs.aws.amazon.com/cli/latest/reference/eks/describe-cluster.html\n https://docs.aws.amazon.com/eks/latest/userguide/create-kubeconfig.html","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"df8f3617-70be-46e0-b181-84fed6378752","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242451","rule_id":"SV-242451r961863","rule_id_src":"SV-242451r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003180","group_title":"The Kubernetes component PKI must be owned by root.","rule_title":"The Kubernetes component PKI must be owned by root.","fix_text":"Change the ownership of the PKI to root: root by executing the command:\n\nchown -R root:root /etc/kubernetes/pki/","false_positives":"","false_negatives":"","discussion":"The Kubernetes PKI directory contains all certificates (.crt files) supporting secure network communications in the Kubernetes Control Plane. If these files can be modified, data traversing within the architecture components would become unsecure and compromised. Many of the security settings within the document are implemented through this file.","check_content":"Review the PKI files in Kubernetes by using the command:\n\nls -laR /etc/kubernetes/pki/\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242451","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"STIG targets /etc/kubernetes/pki on control plane. In EKS, the control plane (and its PKI) runs in an AWS-managed VPC; customers can’t access or set ownership on these files. Mark as provider-managed/not customer-configurable. https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html\n \n","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"fa5d3e0a-6fb8-4c07-a394-f5af4402ae3f","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242452","rule_id":"SV-242452r961863","rule_id_src":"SV-242452r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003190","group_title":"The Kubernetes kubelet KubeConfig must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes kubelet KubeConfig must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of the Kubelet to \"644\" by executing the command:\n\nchmod 644 /etc/kubernetes/kubelet.conf","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubelet agent registers nodes with the API Server, mounts volume storage for pods, and performs health checks to containers within pods. If these files can be modified, the information system would be unaware of pod or container degradation. Many of the security settings within the document are implemented through this file.","check_content":"Review the permissions of the Kubernetes Kubelet conf by using the command:\n\nstat -c %a  /etc/kubernetes/kubelet.conf\n\nIf any of the files are have permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242452","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"/var/lib/kubelet/kubeconfig ","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"866a81be-0edc-4539-a380-4c72765fc4ca","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242453","rule_id":"SV-242453r961863","rule_id_src":"SV-242453r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003200","group_title":"The Kubernetes kubelet KubeConfig file must be owned by root.","rule_title":"The Kubernetes kubelet KubeConfig file must be owned by root.","fix_text":"Change the ownership of the kubelet.conf to root: root by executing the command:\n\nchown root:root /etc/kubernetes/kubelet.conf","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubelet agent registers nodes with the API server and performs health checks to containers within pods. If these files can be modified, the information system would be unaware of pod or container degradation. Many of the security settings within the document are implemented through this file.","check_content":"Review the Kubernetes Kubelet conf files by using the command:\n\nstat -c %U:%G /etc/kubernetes/kubelet.conf| grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242453","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"/var/lib/kubelet/kubeconfig ","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"eaf99179-5f5f-48b4-8a01-a26e2f6b4f48","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242454","rule_id":"SV-242454r961863","rule_id_src":"SV-242454r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003210","group_title":"The Kubernetes kubeadm.conf must be owned by root.","rule_title":"The Kubernetes kubeadm.conf must be owned by root.","fix_text":"Change the ownership of the kubeadm.conf to root: root by executing the command:\n\nchown root:root <kubeadm.conf path>","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubeeadm.conf contains sensitive information regarding the cluster nodes configuration. If this file can be modified, the Kubernetes Platform Plane would be degraded or compromised for malicious intent. Many of the security settings within the document are implemented through this file.","check_content":"Review the Kubeadm.conf file :\n\nGet the path for Kubeadm.conf by running: \nsytstemctl status kubelet\n\nNote the configuration file installed by the kubeadm is written to \n(Default Location: /etc/systemd/system/kubelet.service.d/10-kubeadm.conf)\nstat -c %U:%G <kubeadm.conf path> | grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding. ","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242454","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"d4f7e5ae-7485-455a-93c8-11cc3e77183b","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242455","rule_id":"SV-242455r961863","rule_id_src":"SV-242455r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003220","group_title":"The Kubernetes kubeadm.conf must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes kubeadm.conf must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of kubeadm.conf to \"644\" by executing the command:\n\nchmod 644 <kubeadm.conf path> ","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubeadm.conf contains sensitive information regarding the cluster nodes configuration. If this file can be modified, the Kubernetes Platform Plane would be degraded or compromised for malicious intent. Many of the security settings within the document are implemented through this file.","check_content":"Review the kubeadm.conf file :\n\nGet the path for kubeadm.conf by running:\nsystemctl status kubelet\n\nNote the configuration file installed by the kubeadm is written to\n(Default Location: /etc/systemd/system/kubelet.service.d/10-kubeadm.conf)\nstat -c %a  <kubeadm.conf path>\n\nIf the file has permissions more permissive than \"644\", this is a finding. ","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242455","title":"SRG-APP-000516-CTR-001325","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001325"},{"uuid":"09593a39-6867-4a22-9f30-9456dad2c8df","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242456","rule_id":"SV-242456r961863","rule_id_src":"SV-242456r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003230","group_title":"The Kubernetes kubelet config must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes kubelet config must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of the config.yaml to \"644\" by executing the command:\n\nchmod 644 /var/lib/kubelet/config.yaml","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubelet agent registers nodes with the API server and performs health checks to containers within pods. If this file can be modified, the information system would be unaware of pod or container degradation.","check_content":"Review the permissions of the Kubernetes config.yaml by using the command:\n\nstat -c %a /var/lib/kubelet/config.yaml\n\nIf any of the files are have permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242456","title":"SRG-APP-000516-CTR-001330","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001330"},{"uuid":"0ae78eb3-f3e6-464a-a367-a24622e4f017","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242457","rule_id":"SV-242457r961863","rule_id_src":"SV-242457r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003240","group_title":"The Kubernetes kubelet config must be owned by root.","rule_title":"The Kubernetes kubelet config must be owned by root.","fix_text":"Change the ownership of the kubelet config to \"root: root\" by executing the command:\n\nchown root:root /var/lib/kubelet/config.yaml","false_positives":"","false_negatives":"","discussion":"The Kubernetes kubelet agent registers nodes with the API Server and performs health checks to containers within pods. If this file can be modified, the information system would be unaware of pod or container degradation.","check_content":"Review the Kubernetes Kubeadm kubelet conf file by using the command:\n\nstat -c %U:%G /var/lib/kubelet/config.yaml| grep -v root:root\n\nIf the command returns any non root:root file permissions, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242457","title":"SRG-APP-000516-CTR-001330","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000516-CTR-001330"},{"uuid":"329e07f5-4ad8-46d8-89e4-1f4e58a46b9b","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242459","rule_id":"SV-242459r961863","rule_id_src":"SV-242459r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003260","group_title":"The Kubernetes etcd must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes etcd must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of the manifest files to \"644\" by executing the command:\n\nchmod -R 644 /var/lib/etcd/*","false_positives":"","false_negatives":"","discussion":"The Kubernetes etcd key-value store provides a way to store data to the Control Plane. If these files can be changed, data to API object and Control Plane would be compromised.","check_content":"Review the permissions of the Kubernetes etcd by using the command:\n\nls -AR /var/lib/etcd/*\n\nIf any of the files have permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242459","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"File permissions for etcd on control-plane hosts are managed by AWS; customers cannot modify/inspect them. Not a Finding – AWS responsibility.\nLink: https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html#control-plane","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"03e3403e-df76-424f-8c86-c55ac39c68b4","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242460","rule_id":"SV-242460r961863","rule_id_src":"SV-242460r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003270","group_title":"The Kubernetes admin kubeconfig must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes admin kubeconfig must have file permissions set to 644 or more restrictive.","fix_text":"Change the permissions of the conf files to \"644\" by executing the command:\n\nchmod 644 /etc/kubernetes/admin.conf \nchmod 644 /etc/kubernetes/scheduler.conf\nchmod 644 /etc/kubernetes/controller-manager.conf","false_positives":"","false_negatives":"","discussion":"The Kubernetes admin kubeconfig files contain the arguments and settings for the Control Plane services. These services are controller and scheduler. If these files can be changed, the scheduler will be implementing the changes immediately.","check_content":"Review the permissions of the Kubernetes config files by using the command:\n\nstat -c %a /etc/kubernetes/admin.conf\nstat -c %a /etc/kubernetes/scheduler.conf\nstat -c %a /etc/kubernetes/controller-manager.conf\n\nIf any of the files are have permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242460","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"These files are on control plane hosts. EKS manages them; customers can’t change or inspect permissions. Mark as provider-managed. https://stigviewer.com/stigs/kubernetes/2024-06-10/finding/V-242460\n ; https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"f46237b9-adde-4caf-8c9e-3dcc6c231488","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242461","rule_id":"SV-242461r961863","rule_id_src":"SV-242461r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003280","group_title":"Kubernetes API Server audit logs must be enabled.","rule_title":"Kubernetes API Server audit logs must be enabled.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the argument \"--audit-policy-file\" to \"log file directory\".","false_positives":"","false_negatives":"","discussion":"Kubernetes API Server validates and configures pods and services for the API object. The REST operation provides frontend functionality to the cluster share state. Enabling audit logs provides a way to monitor and identify security risk events or misuse of information. Audit logs are necessary to provide evidence in the case the Kubernetes API Server is compromised requiring a Cyber Security Investigation.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-policy-file * \n\nIf the setting \"audit-policy-file\" is not set or is found in the Kubernetes API manifest file without valid content, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242461","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"Satisfied is audit logs to cloud watch are setup.","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"5fb5cb89-e656-447e-8d45-9537203e4a77","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242462","rule_id":"SV-242462r961863","rule_id_src":"SV-242462r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003290","group_title":"The Kubernetes API Server must be set to audit log max size.","rule_title":"The Kubernetes API Server must be set to audit log max size.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--audit-log-maxsize\" to a minimum of \"100\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server must be set for enough storage to retain log information over the period required. When audit logs are large in size, the monitoring service for events becomes degraded. The function of the maximum log file size is to set these limits.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-log-maxsize * \n\nIf the setting \"--audit-log-maxsize\" is not set in the Kubernetes API Server manifest file or it is set to less than \"100\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242462","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"Satisfied is audit logs to cloud watch are setup. CloudWatch has an infinite storage size.","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"6b3db931-c28d-4c3c-8097-648d8783b684","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242463","rule_id":"SV-242463r961863","rule_id_src":"SV-242463r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003300","group_title":"The Kubernetes API Server must be set to audit log maximum backup.","rule_title":"The Kubernetes API Server must be set to audit log maximum backup.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--audit-log-maxbackup\" to a minimum of \"10\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server must set enough storage to retain logs for monitoring suspicious activity and system misconfiguration, and provide evidence for Cyber Security Investigations.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-log-maxbackup * \n\nIf the setting \"audit-log-maxbackup\" is not set in the Kubernetes API Server manifest file or it is set less than \"10\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242463","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"The kube-apiserver flag --audit-log-maxbackup isn’t exposed on EKS. Use CloudWatch retention/archives instead to satisfy the intent (ensuring logs are retained for the required period).\n\nRetaining atleast 10 audit log backups would be satisfied with a larger retention period.","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"03064254-f8d3-42d5-bd64-1c7050d68f52","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242464","rule_id":"SV-242464r961863","rule_id_src":"SV-242464r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003310","group_title":"The Kubernetes API Server audit log retention must be set.","rule_title":"The Kubernetes API Server audit log retention must be set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--audit-log-maxage\" to a minimum of \"30\".","false_positives":"","false_negatives":"","discussion":"The Kubernetes API Server must set enough storage to retain logs for monitoring suspicious activity and system misconfiguration, and provide evidence for Cyber Security Investigations.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-log-maxage * \n\nIf the setting \"audit-log-maxage\" is not set in the Kubernetes API Server manifest file or it is set less than \"30\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242464","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"CloudWatch retention for audit logs in cloud watch must be set to at least 30 days.","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"6c6e7c07-4a20-4242-af43-05814d003587","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242465","rule_id":"SV-242465r961863","rule_id_src":"SV-242465r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003320","group_title":"The Kubernetes API Server audit log path must be set.","rule_title":"The Kubernetes API Server audit log path must be set.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--audit-log-path\" to valid location.","false_positives":"","false_negatives":"","discussion":"Kubernetes API Server validates and configures pods and services for the API object. The REST operation provides frontend functionality to the cluster share state. Audit logs are necessary to provide evidence in the case the Kubernetes API Server is compromised requiring Cyber Security Investigation. To record events in the audit log the log path value must be set.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i audit-log-path * \n\nIf the setting audit-log-path is not set in the Kubernetes API Server manifest file or it is not set to a valid path, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242465","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"EKS doesn’t let you set --audit-log-path; AWS emits audit events to your CloudWatch Logs group when Audit logging is enabled. That satisfies centralized collection/availability even without a node filesystem path.","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"de7d5286-70ac-4bfa-aa06-b75d6c379277","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242466","rule_id":"SV-242466r961863","rule_id_src":"SV-242466r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003330","group_title":"The Kubernetes PKI CRT must have file permissions set to 644 or more restrictive.","rule_title":"The Kubernetes PKI CRT must have file permissions set to 644 or more restrictive.","fix_text":"Change the ownership of the cert files to \"644\" by executing the command: \n\nfind /etc/kubernetes/pki -name \"*.crt\" | xargs chmod 644","false_positives":"","false_negatives":"","discussion":"The Kubernetes PKI directory contains all certificates (.crt files) supporting secure network communications in the Kubernetes Control Plane. If these files can be modified, data traversing within the architecture components would become unsecure and compromised.","check_content":"Review the permissions of the Kubernetes PKI cert files by using the command:\n\nsudo find /etc/kubernetes/pki/* -name \"*.crt\" | xargs stat -c '%n %a'\n\nIf any of the files have permissions more permissive than \"644\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242466","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control plane PKI directory (/etc/kubernetes/pki). EKS-managed; not customer-configurable. Not a customer finding. https://stigviewer.cyberprotection.com/stigs/kubernetes/2025-02-20/finding/V-242466\n ; https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"03d4e20e-c0e2-46af-88b6-5183b69bb477","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-242467","rule_id":"SV-242467r961863","rule_id_src":"SV-242467r961863_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-003340","group_title":"The Kubernetes PKI keys must have file permissions set to 600 or more restrictive.","rule_title":"The Kubernetes PKI keys must have file permissions set to 600 or more restrictive.","fix_text":"Change the ownership of the key files to \"600\" by executing the command: \n\nfind /etc/kubernetes/pki -name \"*.key\" | xargs chmod 600","false_positives":"","false_negatives":"","discussion":"The Kubernetes PKI directory contains all certificate key files supporting secure network communications in the Kubernetes Control Plane. If these files can be modified, data traversing within the architecture components would become unsecure and compromised.","check_content":"Review the permissions of the Kubernetes PKI key files by using the command:\n\nsudo find /etc/kubernetes/pki -name \"*.key\" | xargs stat -c '%n %a'\n\nIf any of the files have permissions more permissive than \"600\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000366"],"group_tree":[{"id":"V-242467","title":"SRG-APP-000516-CTR-001335","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control plane PKI keys (/etc/kubernetes/pki/*.key). EKS-managed; not customer-configurable. Not a customer finding. https://stigviewer.com/stigs/kubernetes/2024-06-10/finding/V-242467\n ; https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.html","srg_id":"SRG-APP-000516-CTR-001335"},{"uuid":"548a57d3-1043-48e3-9ecf-1a739a7d5e5d","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-245541","rule_id":"SV-245541r1069469","rule_id_src":"SV-245541r1069469_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001300","group_title":"Kubernetes Kubelet must not disable timeouts.","rule_title":"Kubernetes Kubelet must not disable timeouts.","fix_text":"Follow these steps to configure streaming-connection-idle-timeout:\n1. On the Control Plane, run the command:\nps -ef | grep kubelet\n\nRemove the \"--streaming-connection-idle-timeout\" option if present.\n\nNote the path to the config file (identified by --config).\n\n2. Edit the Kubernetes Kubelet file in the --config directory on the Kubernetes Control Plane:\n\nSet the argument \"streamingConnectionIdleTimeout\" to a value of \"5m\".","false_positives":"","false_negatives":"","discussion":"Idle connections from the Kubelet can be used by unauthorized users to perform malicious activity to the nodes, pods, containers, and cluster within the Kubernetes Control Plane. Setting the streamingConnectionIdleTimeout defines the maximum time an idle session is permitted prior to disconnect. Setting the value to \"0\" never disconnects any idle sessions. Idle timeouts must never be set to \"0\" and should be defined at \"5m\" (the default is 4hr).","check_content":"Follow these steps to check streaming-connection-idle-timeout:\n\n1. On the Control Plane, run the command:\n\nps -ef | grep kubelet\n\nIf the \"--streaming-connection-idle-timeout\" option exists, this is a finding.\n\nNote the path to the config file (identified by --config).\n\n2. Run the command:\n\ngrep -i streamingConnectionIdleTimeout <path_to_config_file>\n\nIf the setting \"streamingConnectionIdleTimeout\" is set to less than \"5m\" or is not configured, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-001133"],"group_tree":[{"id":"V-245541","title":"SRG-APP-000190-CTR-000500","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"open","overrides":{},"comments":"Control Plane","finding_details":"","srg_id":"SRG-APP-000190-CTR-000500"},{"uuid":"025810d9-5bcf-403a-be50-4adc75c765de","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-245542","rule_id":"SV-245542r961632","rule_id_src":"SV-245542r961632_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002620","group_title":"Kubernetes API Server must disable basic authentication to protect information in transit.","rule_title":"Kubernetes API Server must disable basic authentication to protect information in transit.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Remove the setting \"--basic-auth-file\".","false_positives":"","false_negatives":"","discussion":"Kubernetes basic authentication sends and receives request containing username, uid, groups, and other fields over a clear text HTTP communication. Basic authentication does not provide any security mechanisms using encryption standards. PKI certificate-based authentication must be set over a secure channel to ensure confidentiality and integrity. Basic authentication must not be set in the manifest file.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i basic-auth-file * \n\nIf \"basic-auth-file\" is set in the Kubernetes API server manifest file this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002448"],"group_tree":[{"id":"V-245542","title":"SRG-APP-000439-CTR-001080","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Finding details / justification:\nControl plane flag (--basic-auth-file) is deprecated upstream and not exposed in EKS. EKS authenticates via IAM (webhook), service account tokens, and OIDC; customers cannot enable static basic auth on EKS. Treat as provider-managed / not applicable to customers to configure. https://docs.aws.amazon.com/eks/latest/best-practices/identity-and-access-management.html","srg_id":"SRG-APP-000439-CTR-001080"},{"uuid":"c4cf2e0b-c3b1-43cc-ade1-23c4f594a47b","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-245543","rule_id":"SV-245543r961632","rule_id_src":"SV-245543r961632_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002630","group_title":"Kubernetes API Server must disable token authentication to protect information in transit.","rule_title":"Kubernetes API Server must disable token authentication to protect information in transit.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nRemove the setting \"--token-auth-file\".","false_positives":"","false_negatives":"","discussion":"Kubernetes token authentication uses password known as secrets in a plaintext file. This file contains sensitive information such as token, username and user uid. This token is used by service accounts within pods to authenticate with the API Server. This information is very valuable for attackers with malicious intent if the service account is privileged having access to the token. With this token a threat actor can impersonate the service account gaining access to the Rest API service.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i token-auth-file * \n\nIf \"--token-auth-file\" is set in the Kubernetes API server manifest file, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002448"],"group_tree":[{"id":"V-245543","title":"SRG-APP-000439-CTR-001080","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"Control plane flag (--token-auth-file) not exposed in EKS. EKS uses webhook token authentication/SA tokens/OIDC; customers can’t enable static token file auth. Provider-managed; not customer-configurable. https://docs.aws.amazon.com/eks/latest/best-practices/identity-and-access-management.html","srg_id":"SRG-APP-000439-CTR-001080"},{"uuid":"9360b4db-7f8e-4c96-8f0e-6020c399f9c9","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-245544","rule_id":"SV-245544r961632","rule_id_src":"SV-245544r961632_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002640","group_title":"Kubernetes endpoints must use approved organizational certificate and key pair to protect information in transit.","rule_title":"Kubernetes endpoints must use approved organizational certificate and key pair to protect information in transit.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Set the value of \"--kubelet-client-certificate\" and \"--kubelet-client-key\" to an Approved Organizational Certificate and key pair.","false_positives":"","false_negatives":"","discussion":"Kubernetes control plane and external communication is managed by API Server. The main implementation of the API Server is to manage hardware resources for pods and container using horizontal or vertical scaling. Anyone who can gain access to the API Server can effectively control your Kubernetes architecture. Using authenticity protection, the communication can be protected against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\r\n\r\nThe communication session is protected by utilizing transport encryption protocols, such as TLS. TLS provides the Kubernetes API Server with a means to be able to authenticate sessions and encrypt traffic.\r\n\r\nBy default, the API Server does not authenticate to the kubelet HTTPs endpoint. To enable secure communication for API Server, the parameter -kubelet-client-certificate and kubelet-client-key must be set. This parameter gives the location of the certificate and key pair used to secure API Server communication.","check_content":"Change to the /etc/kubernetes/manifests/ directory on the Kubernetes Control Plane. Run the command:\ngrep -i kubelet-client-certificate *\ngrep -I kubelet-client-key * \n\nIf the setting \"--kubelet-client-certificate\" is not configured in the Kubernetes API server manifest file or contains no value, this is a finding.\n\nIf the setting \"--kubelet-client-key\" is not configured in the Kubernetes API server manifest file or contains no value, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002448"],"group_tree":[{"id":"V-245544","title":"SRG-APP-000439-CTR-001080","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"These API server flags are control-plane settings; EKS manages the mTLS between API server and kubelets and doesn’t expose these flags. Mark as provider-managed; not customer-configurable. https://docs.aws.amazon.com/eks/latest/best-practices/control-plane.htm","srg_id":"SRG-APP-000439-CTR-001080"},{"uuid":"5fc8c50d-cc13-4712-bbf8-59a4d5ce949d","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-254800","rule_id":"SV-254800r961359","rule_id_src":"SV-254800r961359_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002011","group_title":"Kubernetes must have a Pod Security Admission control file configured.","rule_title":"Kubernetes must have a Pod Security Admission control file configured.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. \n\nSet the value of \"--admission-control-config-file\" to a valid path for the file.\n\nCreate an admission controller config file:\nExample File:\n```yaml\napiVersion: apiserver.config.k8s.io/v1\nkind: AdmissionConfiguration\nplugins:\n- name: PodSecurity\n  configuration:\n    apiVersion: pod-security.admission.config.k8s.io/v1beta1\n    kind: PodSecurityConfiguration\n    # Defaults applied when a mode label is not set.\n    defaults:\n      enforce: \"privileged\"\n      enforce-version: \"latest\"\n    exemptions:\n      # Don't forget to exempt namespaces or users that are responsible for deploying\n      # cluster components, because they need to run privileged containers\n      usernames: [\"admin\"] \n      namespaces: [\"kube-system\"]\n\nSee for more details:\nMigrate from PSP to PSA:\nhttps://kubernetes.io/docs/tasks/configure-pod-container/migrate-from-psp/\n\nBest Practice: https://kubernetes.io/docs/concepts/security/pod-security-policy/#recommended-practice.","false_positives":"","false_negatives":"","discussion":"An admission controller intercepts and processes requests to the Kubernetes API prior to persistence of the object, but after the request is authenticated and authorized.\n\nKubernetes (> v1.23)offers a built-in Pod Security admission controller to enforce the Pod Security Standards. Pod security restrictions are applied at the namespace level when pods are created. \n\nThe Kubernetes Pod Security Standards define different isolation levels for Pods. These standards define how to restrict the behavior of pods in a clear, consistent fashion.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Control Plane. Run the command:\n\n\"grep -i admission-control-config-file *\"\n\nIf the setting \"--admission-control-config-file\" is not configured in the Kubernetes API Server manifest file, this is a finding.\n\nInspect the .yaml file defined by the --admission-control-config-file. Verify PodSecurity is properly configured. \nIf least privilege is not represented, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002263"],"group_tree":[{"id":"V-254800","title":"SRG-APP-000342-CTR-000775","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane","finding_details":"PSA is built into Kubernetes (v1.25+) and present in EKS; customers must enforce via namespace labels (pod-security.kubernetes.io/enforce etc.) at the desired PSS level (baseline/restricted). Control plane enablement is provider-managed; enforcement config is customer-managed via labels/policies. https://www.eksworkshop.com/docs/security/pod-security-standards/\n ; https://stigviewer.com/stigs/kubernetes/2024-08-22/finding/V-254800","srg_id":"SRG-APP-000342-CTR-000775"},{"uuid":"b469af15-cf9c-4f22-ae5a-070d0f8f19eb","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-254801","rule_id":"SV-254801r961359","rule_id_src":"SV-254801r961359_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-002001","group_title":"Kubernetes must enable PodSecurity admission controller on static pods and Kubelets.","rule_title":"Kubernetes must enable PodSecurity admission controller on static pods and Kubelets.","fix_text":"On the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\ngrep -i feature-gates *\n\nEnsure the argument \"--feature-gates=PodSecurity=true\" is present in each manifest file.\n\nOn each Control Plane and Worker Node, run the command:\nps -ef | grep kubelet\n\nRemove the \"--feature-gates\" option if present.\n\nNote the path to the config file (identified by --config).\n\nEdit the Kubernetes Kubelet config file: \nAdd a \"featureGates\" setting if one does not yet exist. Add the feature gate \"PodSecurity=true\".\n\nRestart the kubelet service using the following command:\nsystemctl daemon-reload && systemctl restart kubelet","false_positives":"","false_negatives":"","discussion":"PodSecurity admission controller is a component that validates and enforces security policies for pods running within a Kubernetes cluster. It is responsible for evaluating the security context and configuration of pods against defined policies. \r\n\r\nTo enable PodSecurity admission controller on Static Pods (kube-apiserver, kube-controller-manager, or kube-schedule), the argument \"--feature-gates=PodSecurity=true\" must be set.\r\n\r\nTo enable PodSecurity admission controller on Kubelets, the featureGates PodSecurity=true argument must be set.\r\n\r\n(Note: The PodSecurity feature gate is GA as of  v1.25.)","check_content":"On the Control Plane, change to the manifests' directory at /etc/kubernetes/manifests and run the command:\r\ngrep -i feature-gates *\r\n\r\nFor each manifest file, if the \"--feature-gates\" setting does not exist, does not contain the \"--PodSecurity\" flag, or sets the flag to \"false\", this is a finding.\r\n\r\nOn each Control Plane and Worker Node, run the command:\r\nps -ef | grep kubelet\r\n\r\nIf the \"--feature-gates\" option exists, this is a finding. \r\n\r\nNote the path to the config file (identified by --config).\r\n\r\nInspect the content of the config file:\r\nIf the \"featureGates\" setting is not present, does not contain the \"PodSecurity\" flag, or sets the flag to \"false\", this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002263"],"group_tree":[{"id":"V-254801","title":"SRG-APP-000342-CTR-000775","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"OS","finding_details":"","srg_id":"SRG-APP-000342-CTR-000775"},{"uuid":"1829eb44-1744-4ff8-89bf-aaccb0359673","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-274882","rule_id":"SV-274882r1107233","rule_id_src":"SV-274882r1107233_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-001162","group_title":"Kubernetes Secrets must be encrypted at rest.","rule_title":"Kubernetes Secrets must be encrypted at rest.","fix_text":"Edit the Kubernetes API Server manifest file in the /etc/kubernetes/manifests directory on the Kubernetes Master Node. \n\nSet the value of \"--encryption-provider-config\" to the path to the encryption config. \n\nThe encryption config must specify the Secret's resource and provider. Below is an example:\n{\n  \"kind\": \"EncryptionConfiguration\",\n  \"apiVersion\": \"apiserver.config.k8s.io/v1\",\n  \"resources\": [\n    {\n      \"resources\": [\n        \"secrets\"\n      ],\n      \"providers\": [\n        {\n          \"aescbc\": {\n            \"keys\": [\n              {\n                \"name\": \"aescbckey\",\n                \"secret\": \"xxxxxxxxxxxxxxxxxxx\"\n              }\n            ]\n          }\n        },\n        {\n          \"identity\": {}\n        }\n      ]\n    }\n  ]\n}","false_positives":"","false_negatives":"","discussion":"Kubernetes Secrets may store sensitive information such as passwords, tokens, and keys. These values are stored in the etcd database used by Kubernetes unencrypted. To protect these Secrets at rest, these values must be encrypted.","check_content":"Change to the /etc/kubernetes/manifests directory on the Kubernetes Master Node. Run the command:\ngrep -i encryption-provider-config *\n\nIf the setting \"encryption-provider-config\" is not configured, this is a finding.\n\nIf the setting is configured, check the contents of the file specified by its argument. \n\nIf the file does not specify the Secret's resource, this is a finding. \n\nIf the identity provider is specified as the first provider for the resource, this is also a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-000213"],"group_tree":[{"id":"V-274882","title":"SRG-APP-000033-CTR-000100","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_a_finding","overrides":{},"comments":"Control Plane\nSDK","finding_details":"This is the one etcd-adjacent item customers DO configure in EKS: enable Secrets encryption with AWS KMS at cluster creation (or via supported update). Evidence = aws eks describe-cluster shows an encryptionConfig with at least resources: [\"secrets\"] and your KMS key ARN. Configure & provide output as evidence.\nLinks:\n\nEKS secrets encryption: https://docs.aws.amazon.com/eks/latest/userguide/encrypt-secrets.html\n\ndescribe-cluster output reference: https://docs.aws.amazon.com/eks/latest/APIReference/API_DescribeCluster.html","srg_id":"SRG-APP-000033-CTR-000100"},{"uuid":"e9f545cd-fd47-4598-9325-8d00513dad69","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-274883","rule_id":"SV-274883r1107230","rule_id_src":"SV-274883r1107230_rule","weight":"10.0","classification":"Unclassified","severity":"high","rule_version":"CNTR-K8-001161","group_title":"Sensitive information must be stored using Kubernetes Secrets or an external Secret store provider.","rule_title":"Sensitive information must be stored using Kubernetes Secrets or an external Secret store provider.","fix_text":"Any sensitive information found must be stored in an approved external Secret store provider or use Kubernetes Secrets (attached on an as-needed basis to pods).","false_positives":"","false_negatives":"","discussion":"Sensitive information, such as passwords, keys, and tokens must not be stored in application code.\n\nKubernetes offers a resource called Secrets that are designed for storing sensitive information for use by applications. Secrets are created and managed separately from application code. Additionally, they can be encrypted at rest and access to the secrets can be controlled via RBAC.","check_content":"On the Kubernetes Master node, run the following command:\nkubectl get all,cm -A -o yaml \n\nManually review the output for sensitive information.\n\nIf any sensitive information is found, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-004062"],"group_tree":[{"id":"V-274883","title":"SRG-APP-000171-CTR-000435","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"not_reviewed","overrides":{},"comments":"API","finding_details":"","srg_id":"SRG-APP-000171-CTR-000435"},{"uuid":"62c69c8d-0b57-4480-b2f5-210ef827342e","stig_uuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","target_key":null,"stig_ref":null,"group_id":"V-274884","rule_id":"SV-274884r1107236","rule_id_src":"SV-274884r1107236_rule","weight":"10.0","classification":"Unclassified","severity":"medium","rule_version":"CNTR-K8-001163","group_title":"Kubernetes must limit Secret access on a need-to-know basis.","rule_title":"Kubernetes must limit Secret access on a need-to-know basis.","fix_text":"For Kubernetes accounts that have read access to Secrets without a documented requirement, modify the corresponding Role or ClusterRole to remove list, watch, and get privileges for Secrets.","false_positives":"","false_negatives":"","discussion":"Kubernetes secrets may store sensitive information such as passwords, tokens, and keys. Access to these secrets should be limited to a need-to-know basis via Kubernetes RBAC.","check_content":"Review the Kubernetes accounts and their corresponding roles. \n\nIf any accounts have read (list, watch, get) access to Secrets without a documented organizational requirement, this is a finding. \n\nRun the below command to list the workload resources for applications deployed to Kubernetes:\nkubectl get all -A -o yaml \n\nIf Secrets are attached to applications without a documented requirement, this is a finding.","documentable":"false","mitigations":"","potential_impacts":"","third_party_tools":"","mitigation_control":"","responsibility":"","security_override_guidance":"","ia_controls":"","check_content_ref":{"href":"Kubernetes_STIG.xml","name":"M"},"legacy_ids":[],"ccis":["CCI-002476"],"group_tree":[{"id":"V-274884","title":"SRG-APP-000429-CTR-001060","description":"<GroupDescription></GroupDescription>"}],"createdAt":"2025-10-08T16:47:04.909Z","updatedAt":"2025-10-08T16:47:04.909Z","STIGUuid":"5820fc35-f94d-4f91-be2d-b9ad805daca5","status":"open","overrides":{},"comments":"API","finding_details":"kubectl get all -A -o yaml is an awful command to run... that would literally dump everything...\n\n","srg_id":"SRG-APP-000429-CTR-001060"}]}],"active":false,"mode":2,"has_path":true,"target_data":{"target_type":"Computing","host_name":"","ip_address":"","mac_address":"","fqdn":"","comments":"","role":"None","is_web_database":false,"technology_area":"","web_db_site":"","web_db_instance":"","classification":null}}